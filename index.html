<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
    <title>Akhirah Assets</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Hind+Siliguri:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Babel for compiling React/TS in browser -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind Configuration -->
    <script>
      tailwind.config = {
        darkMode: 'class',
        theme: {
          extend: {
            fontFamily: {
              sans: ['"Hind Siliguri"', 'sans-serif'],
            },
            colors: {
              islamic: {
                50: '#f0fdf4',
                100: '#dcfce7',
                500: '#22c55e',
                600: '#16a34a',
                800: '#166534',
                900: '#14532d',
              },
              night: {
                900: '#000000', /* Pitch Black */
                800: '#121212', /* Card Background */
                700: '#1e293b', /* Borders/Hover */
              }
            },
            animation: {
              'pulse-slow': 'pulse 3s cubic-bezier(0.4, 0, 0.6, 1) infinite',
              'grow': 'grow 0.5s ease-out forwards',
            },
            keyframes: {
              grow: {
                '0%': { transform: 'scale(0)' },
                '100%': { transform: 'scale(1)' },
              }
            }
          },
        },
      }
    </script>

    <!-- Global Styles -->
    <style>
      body {
        font-family: 'Hind Siliguri', sans-serif;
        -webkit-tap-highlight-color: transparent;
      }
      .glass {
        background: rgba(255, 255, 255, 0.7);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        border: 1px solid rgba(255, 255, 255, 0.18);
      }
      .dark .glass {
        background: rgba(18, 18, 18, 0.7);
        border: 1px solid rgba(255, 255, 255, 0.08);
      }
      /* Hide scrollbar for clean UI */
      .no-scrollbar::-webkit-scrollbar {
        display: none;
      }
      .no-scrollbar {
        -ms-overflow-style: none;
        scrollbar-width: none;
      }
    </style>

    <!-- Import Map for External Libraries -->
    <script type="importmap">
    {
      "imports": {
        "react": "https://esm.sh/react@18.2.0",
        "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
        "lucide-react": "https://esm.sh/lucide-react@0.292.0",
        "recharts": "https://esm.sh/recharts@2.10.3",
        "react-hot-toast": "https://esm.sh/react-hot-toast@2.4.1",
        "canvas-confetti": "https://esm.sh/canvas-confetti@1.9.2"
      }
    }
    </script>
</head>
<body class="bg-islamic-50 dark:bg-night-900 text-slate-800 dark:text-slate-100">
    <div id="root"></div>

    <!-- Main Application Script -->
    <script type="text/babel" data-type="module" data-presets="react,typescript">
        import React, { useState, useEffect, useRef, useMemo, useCallback } from 'react';
        import ReactDOM from 'react-dom/client';
        import { 
            Sun, Moon, Mail, Fingerprint, ClipboardCheck, ChevronLeft, Plus, FolderCog, Pencil, Trash2, X, 
            Pause, CheckCircle2, Circle, PenLine, Calendar, FolderOpen, Save, Quote, ChevronRight, FileText, 
            Clock, History, TrendingUp, MailOpen, CheckSquare, Home, BookOpen, BarChart2, Sprout, 
            TreeDeciduous, CalendarDays 
        } from 'lucide-react';
        import { BarChart, Bar, XAxis, ResponsiveContainer, Cell } from 'recharts';
        import { Toaster, toast } from 'react-hot-toast';
        import confetti from 'canvas-confetti';

        // --- TYPES SECTION (Merged from types.ts) ---
        
        // Interfaces are removed in compilation, but we keep enums
        enum View {
            HOME = 'HOME',
            TASBIH_LIST = 'TASBIH_LIST',
            FOCUS_MODE = 'FOCUS_MODE',
            TARGET_LIST = 'TARGET_LIST',
            JOURNAL = 'JOURNAL',
            GARDEN = 'GARDEN',
            ANALYSIS = 'ANALYSIS',
            INBOX = 'INBOX'
        }

        // --- CONSTANTS SECTION (Merged from constants.ts) ---

        const DEFAULT_TASBIHS = [
            { 
                id: '1', 
                name: '‡¶∏‡ßÅ‡¶¨‡¶π‡¶æ‡¶®‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶π', 
                arabicText: 'ÿ≥Ÿèÿ®Ÿíÿ≠ŸéÿßŸÜŸé Ÿ±ŸÑŸÑŸéŸëŸ∞ŸáŸê', 
                banglaMeaning: '‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶™‡¶¨‡¶ø‡¶§‡ßç‡¶∞',
                schedule: 'everyday',
                count: 0, 
                totalCount: 0,
                todayTime: 0
            },
            { 
                id: '2', 
                name: '‡¶Ü‡¶≤‡¶π‡¶æ‡¶Æ‡¶¶‡ßÅ‡¶≤‡¶ø‡¶≤‡ßç‡¶≤‡¶æ‡¶π', 
                arabicText: 'Ÿ±ŸÑŸíÿ≠ŸéŸÖŸíÿØŸè ŸÑŸêŸÑŸéŸëŸ∞ŸáŸê', 
                banglaMeaning: '‡¶∏‡¶ï‡¶≤ ‡¶™‡ßç‡¶∞‡¶∂‡¶Ç‡¶∏‡¶æ ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶∞',
                schedule: 'everyday',
                count: 0, 
                totalCount: 0,
                todayTime: 0
            },
            { 
                id: '3', 
                name: '‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡ßÅ ‡¶Ü‡¶ï‡¶¨‡¶æ‡¶∞', 
                arabicText: 'Ÿ±ŸÑŸÑŸéŸëŸ∞ŸáŸè ÿ£ŸéŸÉŸíÿ®Ÿéÿ±Ÿè', 
                banglaMeaning: '‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶Æ‡¶π‡¶æ‡¶®',
                schedule: 'everyday',
                count: 0, 
                totalCount: 0,
                todayTime: 0
            },
            { 
                id: '4', 
                name: '‡¶≤‡¶æ ‡¶á‡¶≤‡¶æ‡¶π‡¶æ ‡¶á‡¶≤‡ßç‡¶≤‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡ßÅ', 
                arabicText: 'ŸÑŸéÿß ÿ•ŸêŸÑŸéŸ∞ŸáŸé ÿ•ŸêŸÑŸéŸëÿß Ÿ±ŸÑŸÑŸéŸëŸ∞ŸáŸè', 
                banglaMeaning: '‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶õ‡¶æ‡¶°‡¶º‡¶æ ‡¶ï‡ßã‡¶®‡ßã ‡¶á‡¶≤‡¶æ‡¶π ‡¶®‡ßá‡¶á',
                schedule: 'everyday',
                count: 0, 
                totalCount: 0,
                todayTime: 0
            },
            { 
                id: '5', 
                name: '‡¶Ü‡¶∏‡ßç‡¶§‡¶æ‡¶ó‡¶´‡¶ø‡¶∞‡ßÅ‡¶≤‡ßç‡¶≤‡¶æ‡¶π', 
                arabicText: 'ÿ£Ÿéÿ≥Ÿíÿ™Ÿéÿ∫ŸíŸÅŸêÿ±Ÿè Ÿ±ŸÑŸÑŸéŸëŸ∞ŸáŸé', 
                banglaMeaning: '‡¶Ü‡¶Æ‡¶ø ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡¶®‡¶æ ‡¶ï‡¶∞‡¶õ‡¶ø',
                schedule: 'everyday',
                count: 0, 
                totalCount: 0,
                todayTime: 0
            },
        ];

        const DEFAULT_TARGETS = [
            { id: 't1', name: '‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶¨‡¶æ‡¶ï‡¶æ‡¶∞‡¶æ‡¶∞ ‡¶∂‡ßá‡¶∑ ‡ß© ‡¶Ü‡¶Ø‡¶º‡¶æ‡¶§', description: '‡¶∞‡¶æ‡¶§‡ßá ‡¶™‡¶æ‡¶† ‡¶ï‡¶∞‡¶≤‡ßá ‡¶∏‡¶æ‡¶∞‡¶æ‡¶∞‡¶æ‡¶§ ‡¶á‡¶¨‡¶æ‡¶¶‡¶§‡ßá‡¶∞ ‡¶∏‡¶ì‡¶Ø‡¶º‡¶æ‡¶¨', neki: 2500, completed: false },
            { id: 't2', name: '‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶Ü‡¶∞ ‡¶∞‡¶π‡¶Æ‡¶æ‡¶®', description: '‡¶¶‡¶ø‡¶®‡ßá ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶§‡¶ø‡¶≤‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ‡¶§', neki: 16000, completed: false },
            { id: 't3', name: '‡¶Ü‡¶Ø‡¶º‡¶æ‡¶§‡ßÅ‡¶≤ ‡¶ï‡ßÅ‡¶∞‡¶∏‡¶ø', description: '‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶ì‡¶Ø‡¶º‡¶æ‡¶ï‡ßç‡¶§ ‡¶∏‡¶æ‡¶≤‡¶æ‡¶§‡ßá‡¶∞ ‡¶™‡¶∞', neki: 1700, completed: false },
            { id: 't4', name: '‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶Æ‡ßÇ‡¶≤‡¶ï', description: '‡¶ò‡ßÅ‡¶Æ‡¶æ‡¶®‡ßã‡¶∞ ‡¶Ü‡¶ó‡ßá ‡¶™‡¶æ‡¶†', neki: 3000, completed: false },
        ];

        const WELCOME_MESSAGE = {
            id: 'welcome',
            title: '‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ!',
            body: '‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶Ü‡¶Æ‡¶≤‡¶®‡¶æ‡¶Æ‡¶æ ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶∏‡ßç‡¶¨‡¶æ‡¶ó‡¶§‡¶Æ‡•§ ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ø‡¶æ‡¶§‡ßç‡¶∞‡¶æ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßã‡¶ï ‡¶®‡ßá‡¶ï ‡¶Ü‡¶Æ‡¶≤‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá‡•§',
            date: new Date().toISOString(),
            read: false,
            type: 'info'
        };

        const DEMO_REPORT_MESSAGE = {
            id: 'demo_report',
            title: '‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü (‡¶°‡ßá‡¶Æ‡ßã)',
            body: `‡¶Ü‡¶∏‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ ‡¶Ü‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ,\n‡¶è‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶°‡ßá‡¶Æ‡ßã ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡•§ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶≠‡ßã‡¶∞ ‡ß™:‡ß©‡ß¶ ‡¶è ‡¶Ü‡¶™‡¶®‡¶ø ‡¶ó‡¶§‡¶ï‡¶æ‡¶≤‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶≤‡ßá‡¶∞ ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ ‡¶™‡¶æ‡¶¨‡ßá‡¶®‡•§\n\n‡¶è‡¶õ‡¶æ‡ßú‡¶æ‡¶ì:\nüìÖ **‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü:** ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞‡¶¨‡¶æ‡¶∞ ‡¶≠‡ßã‡¶∞ ‡ß™:‡ß©‡ß¶ ‡¶è‡•§\nüóì **‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü:** ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡ßß ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ ‡¶≠‡ßã‡¶∞ ‡ß™:‡ß©‡ß¶ ‡¶è‡•§\n\n‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶™‡¶æ‡¶†, ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶£, ‡¶∏‡¶Æ‡ßü ‡¶¨‡ßç‡¶Ø‡ßü, ‡¶Ö‡¶∞‡ßç‡¶ú‡¶ø‡¶§ ‡¶®‡ßá‡¶ï‡¶ø ‡¶è‡¶¨‡¶Ç **‡¶∞‡ßã‡¶™‡¶®‡¶ï‡ßÉ‡¶§ ‡¶ó‡¶æ‡¶õ‡ßá‡¶∞ ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨** ‡¶•‡¶æ‡¶ï‡¶¨‡ßá‡•§`,
            date: new Date().toISOString(),
            read: false,
            type: 'report'
        };

        const DISCLAIMER_MESSAGE = {
            id: 'disclaimer',
            title: '‡¶®‡ßá‡¶ï‡¶ø ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶™‡ßç‡¶∞‡¶∏‡¶ô‡ßç‡¶ó‡ßá',
            body: `‡¶™‡ßç‡¶∞‡¶ø‡ßü ‡¶¶‡ßç‡¶¨‡ßÄ‡¶®‡¶ø ‡¶≠‡¶æ‡¶á/‡¶¨‡ßã‡¶®,\n‡¶è‡¶á ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶™‡ßá ‡¶™‡ßç‡¶∞‡¶¶‡¶∞‡ßç‡¶∂‡¶ø‡¶§ ‡¶®‡ßá‡¶ï‡¶ø‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨‡¶ü‡¶ø ‡¶è‡¶ï‡¶ü‡¶ø ‡¶Ü‡¶®‡ßÅ‡¶Æ‡¶æ‡¶®‡¶ø‡¶ï ‡¶ß‡¶æ‡¶∞‡¶£‡¶æ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞‡•§ ‡¶π‡¶æ‡¶¶‡¶ø‡¶∏ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶®‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶π‡¶∞‡¶´‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡ßß‡ß¶‡¶ü‡¶ø ‡¶®‡ßá‡¶ï‡¶ø ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§, ‡¶∏‡ßá‡¶á ‡¶≠‡¶ø‡¶§‡ßç‡¶§‡¶ø‡¶§‡ßá ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ó‡¶£‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡•§\n\n‡¶§‡¶¨‡ßá ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶™‡¶æ‡¶ï ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ú‡¶æ‡¶®‡ßá‡¶® ‡¶è‡¶¨‡¶Ç ‡¶§‡¶ø‡¶®‡¶ø ‡¶Ø‡¶æ‡¶ï‡ßá ‡¶á‡¶ö‡ßç‡¶õ‡¶æ ‡¶¨‡¶π‡ßÅ‡¶ó‡ßÅ‡¶£ ‡¶¨‡¶æ‡ßú‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶®‡•§ ‡¶á‡¶ñ‡¶≤‡¶æ‡¶∏ ‡¶ì ‡¶®‡¶ø‡ßü‡¶§ ‡¶Ö‡¶®‡ßÅ‡¶Ø‡¶æ‡ßü‡ßÄ ‡¶è‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ ‡¶ï‡¶Æ-‡¶¨‡ßá‡¶∂‡¶ø ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡ßá‡•§\n\n‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßç‡¶Ø ‡¶π‡¶≤‡ßã ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶Ü‡¶Æ‡¶≤‡ßá ‡¶â‡ßé‡¶∏‡¶æ‡¶π‡¶ø‡¶§ ‡¶ï‡¶∞‡¶æ‡•§ ‡¶Æ‡¶π‡¶æ‡¶® ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶Ü‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶á‡¶¨‡¶æ‡¶¶‡¶§ ‡¶ï‡¶¨‡ßÅ‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§ ‡¶Ü‡¶Æ‡¶ø‡¶®‡•§`,
            date: new Date().toISOString(),
            read: false,
            type: 'info'
        };

        const LEVEL_THRESHOLD = 100000;
        const DAYS_OF_WEEK = ['‡¶∂‡¶®‡¶ø', '‡¶∞‡¶¨‡¶ø', '‡¶∏‡ßã‡¶Æ', '‡¶Æ‡¶ô‡ßç‡¶ó‡¶≤', '‡¶¨‡ßÅ‡¶ß', '‡¶¨‡ßÉ‡¶π‡¶É', '‡¶∂‡ßÅ‡¶ï‡ßç‡¶∞'];

        const ISLAMIC_DATABASE = [
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß®:‡ßß‡ß´‡ß®)", text: "‡¶ï‡¶æ‡¶ú‡ßá‡¶á ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶∏‡ßç‡¶Æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßã, ‡¶Ü‡¶Æ‡¶ø‡¶ì ‡¶§‡ßã‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡ßç‡¶Æ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶¨‡•§ ‡¶Ü‡¶∞ ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶Æ‡¶æ‡¶∞ ‡¶ï‡ßÉ‡¶§‡¶ú‡ßç‡¶û‡¶§‡¶æ ‡¶Ü‡¶¶‡¶æ‡ßü ‡¶ï‡¶∞‡ßã ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶ï‡ßÉ‡¶§‡¶ú‡ßç‡¶û ‡¶π‡ßü‡ßã ‡¶®‡¶æ‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ßß", text: "‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü‡¶á ‡¶∏‡¶Æ‡¶∏‡ßç‡¶§ ‡¶Ü‡¶Æ‡¶≤ ‡¶®‡¶ø‡ßü‡¶§‡ßá‡¶∞ ‡¶â‡¶™‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶≠‡¶∞‡¶∂‡ßÄ‡¶≤‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß®‡ßØ:‡ß™‡ß´)", text: "‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü‡¶á ‡¶®‡¶æ‡¶Æ‡¶æ‡¶Ø ‡¶Ö‡¶∂‡ßç‡¶≤‡ßÄ‡¶≤ ‡¶ì ‡¶ó‡¶∞‡ßç‡¶π‡¶ø‡¶§ ‡¶ï‡¶æ‡¶ú ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶ø‡¶∞‡¶§ ‡¶∞‡¶æ‡¶ñ‡ßá‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶Æ‡ßÅ‡¶∏‡¶≤‡¶ø‡¶Æ, ‡ß®‡ß®‡ß®", text: "‡¶™‡¶¨‡¶ø‡¶§‡ßç‡¶∞‡¶§‡¶æ ‡¶à‡¶Æ‡¶æ‡¶®‡ßá‡¶∞ ‡¶Ö‡¶∞‡ßç‡¶ß‡ßá‡¶ï‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß©:‡ßß‡ß©‡ß™)", text: "‡¶Ø‡¶æ‡¶∞‡¶æ ‡¶∏‡¶ö‡ßç‡¶õ‡¶≤ ‡¶ì ‡¶Ö‡¶∏‡¶ö‡ßç‡¶õ‡¶≤ ‡¶Ö‡¶¨‡¶∏‡ßç‡¶•‡¶æ‡ßü ‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡ßá, ‡¶∞‡¶æ‡¶ó ‡¶®‡¶ø‡ßü‡¶®‡ßç‡¶§‡ßç‡¶∞‡¶£ ‡¶ï‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑‡¶ï‡ßá ‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ ‡¶ï‡¶∞‡ßá‡•§ ‡¶Ü‡¶∞ ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶∏‡ßé‡¶ï‡¶∞‡ßç‡¶Æ‡¶∂‡ßÄ‡¶≤‡¶¶‡ßá‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡ßá‡¶®‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ß¨‡ß¶‡ßß‡ßß", text: "‡¶≤‡¶ú‡ßç‡¶ú‡¶æ ‡¶à‡¶Æ‡¶æ‡¶®‡ßá‡¶∞ ‡¶Ö‡¶ô‡ßç‡¶ó‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ßØ‡ß™:‡ß´-‡ß¨)", text: "‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü‡¶á ‡¶ï‡¶∑‡ßç‡¶ü‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡ßç‡¶¨‡¶∏‡ßç‡¶§‡¶ø ‡¶∞‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü‡¶á ‡¶ï‡¶∑‡ßç‡¶ü‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡ßç‡¶¨‡¶∏‡ßç‡¶§‡¶ø ‡¶∞‡ßü‡ßá‡¶õ‡ßá‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ßß‡ß©", text: "‡¶§‡ßã‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶ï‡ßá‡¶â ‡¶§‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶™‡¶∞‡ßç‡¶Ø‡¶®‡ßç‡¶§ ‡¶Æ‡ßÅ‡¶Æ‡¶ø‡¶® ‡¶π‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ, ‡¶Ø‡¶§‡¶ï‡ßç‡¶∑‡¶£ ‡¶®‡¶æ ‡¶∏‡ßá ‡¶§‡¶æ‡¶∞ ‡¶≠‡¶æ‡¶á‡ßü‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶§‡¶æ‡¶á ‡¶™‡¶õ‡¶®‡ßç‡¶¶ ‡¶ï‡¶∞‡¶¨‡ßá ‡¶Ø‡¶æ ‡¶∏‡ßá ‡¶®‡¶ø‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶™‡¶õ‡¶®‡ßç‡¶¶ ‡¶ï‡¶∞‡ßá‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß®:‡ß®‡ßÆ‡ß¨)", text: "‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶ï‡ßã‡¶®‡ßã ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø‡¶ï‡ßá ‡¶§‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶ß‡ßç‡¶Ø‡ßá‡¶∞ ‡¶¨‡¶æ‡¶á‡¶∞‡ßá ‡¶¶‡¶æ‡ßü‡¶ø‡¶§‡ßç‡¶¨ ‡¶ö‡¶æ‡¶™‡¶ø‡ßü‡ßá ‡¶¶‡ßá‡¶® ‡¶®‡¶æ‡•§" },
            { source: "‡¶∞‡¶ø‡ßü‡¶æ‡¶¶‡ßÅ‡¶∏ ‡¶∏‡¶æ‡¶≤‡¶ø‡¶π‡ßÄ‡¶®, ‡ß¨", text: "‡¶¶‡ßÅ‡¶®‡¶ø‡¶Ø‡¶º‡¶æ ‡¶Æ‡ßÅ‡¶Æ‡¶ø‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ï‡¶æ‡¶∞‡¶æ‡¶ó‡¶æ‡¶∞ ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶æ‡¶´‡ßá‡¶∞‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶ú‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶§‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ßß‡ß≠:‡ß®‡ß©)", text: "‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶™‡¶ø‡¶§‡¶æ-‡¶Æ‡¶æ‡¶§‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶∏‡¶¶‡ßç‡¶¨‡ßç‡¶Ø‡¶¨‡¶π‡¶æ‡¶∞ ‡¶ï‡¶∞‡ßã‡•§ ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶è‡¶ï‡¶ú‡¶® ‡¶¨‡¶æ ‡¶â‡¶≠‡ßü‡ßá ‡¶Ø‡¶¶‡¶ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶ú‡ßÄ‡¶¨‡¶¶‡ßç‡¶¶‡¶∂‡¶æ‡ßü ‡¶¨‡¶æ‡¶∞‡ßç‡¶ß‡¶ï‡ßç‡¶Ø‡ßá ‡¶â‡¶™‡¶®‡ßÄ‡¶§ ‡¶π‡ßü, ‡¶§‡¶¨‡ßá ‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶â‡¶¶‡ßç‡¶¶‡ßá‡¶∂‡ßá ‚Äò‡¶â‡¶π‚Äô ‡¶∂‡¶¨‡ßç‡¶¶‡¶ü‡¶ø‡¶ì ‡¶¨‡¶≤‡ßã ‡¶®‡¶æ‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ß¨‡ß™‡ßß‡ß®", text: "‡¶¶‡ßÅ‡¶ü‡¶ø ‡¶®‡¶ø‡ßü‡¶æ‡¶Æ‡¶§ ‡¶è‡¶Æ‡¶® ‡¶Ü‡¶õ‡ßá, ‡¶Ø‡ßá ‡¶¨‡¶ø‡¶∑‡ßü‡ßá ‡¶Ö‡¶®‡ßá‡¶ï ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑ ‡¶ß‡ßã‡¶Å‡¶ï‡¶æ‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∞‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶§‡¶æ ‡¶π‡¶≤‡ßã‚Äî‡¶∏‡ßÅ‡¶∏‡ßç‡¶•‡¶§‡¶æ ‡¶ì ‡¶Ö‡¶¨‡¶∏‡¶∞‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ßß‡ß¶‡ß©:‡ßß-‡ß©)", text: "‡¶∏‡¶Æ‡ßü‡ßá‡¶∞ ‡¶∂‡¶™‡¶•! ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑ ‡¶ï‡ßç‡¶∑‡¶§‡¶ø‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶∞‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶§‡¶¨‡ßá ‡¶§‡¶æ‡¶∞‡¶æ ‡¶õ‡¶æ‡ßú‡¶æ ‡¶Ø‡¶æ‡¶∞‡¶æ ‡¶à‡¶Æ‡¶æ‡¶® ‡¶è‡¶®‡ßá‡¶õ‡ßá, ‡¶∏‡ßé‡¶ï‡¶æ‡¶ú ‡¶ï‡¶∞‡ßá‡¶õ‡ßá, ‡¶™‡¶∞‡¶∏‡ßç‡¶™‡¶∞‡¶ï‡ßá ‡¶∏‡¶§‡ßç‡¶Ø‡ßá‡¶∞ ‡¶â‡¶™‡¶¶‡ßá‡¶∂ ‡¶¶‡¶ø‡ßü‡ßá‡¶õ‡ßá ‡¶è‡¶¨‡¶Ç ‡¶ß‡ßà‡¶∞‡ßç‡¶Ø‡ßá‡¶∞ ‡¶â‡¶™‡¶¶‡ßá‡¶∂ ‡¶¶‡¶ø‡ßü‡ßá‡¶õ‡ßá‡•§" },
            { source: "‡¶∏‡ßÅ‡¶®‡¶æ‡¶®‡ßá ‡¶á‡¶¨‡¶®‡ßá ‡¶Æ‡¶æ‡¶ú‡¶æ‡¶π, ‡ß®‡ß®‡ß™", text: "‡¶ú‡ßç‡¶û‡¶æ‡¶® ‡¶Ö‡¶®‡ßç‡¶¨‡ßá‡¶∑‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßá‡¶ï ‡¶Æ‡ßÅ‡¶∏‡¶≤‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶ì‡¶™‡¶∞ ‡¶´‡¶∞‡¶ú‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß™‡ßØ:‡ßß‡ß®)", text: "‡¶π‡ßá ‡¶Æ‡ßÅ‡¶Æ‡¶ø‡¶®‡¶ó‡¶£! ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶Ö‡¶ß‡¶ø‡¶ï‡¶æ‡¶Ç‡¶∂ ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶¶‡ßÇ‡¶∞‡ßá ‡¶•‡¶æ‡¶ï‡ßã‡•§ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü ‡¶ï‡ßã‡¶®‡ßã ‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡¶®‡ßÅ‡¶Æ‡¶æ‡¶® ‡¶™‡¶æ‡¶™‡•§ ‡¶Ü‡¶∞ ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶è‡¶ï‡ßá ‡¶Ö‡¶™‡¶∞‡ßá‡¶∞ ‡¶ó‡ßã‡¶™‡¶®‡ßÄ‡ßü ‡¶¨‡¶ø‡¶∑‡ßü ‡¶Ö‡¶®‡ßÅ‡¶∏‡¶®‡ßç‡¶ß‡¶æ‡¶® ‡¶ï‡¶∞‡ßã ‡¶®‡¶æ‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶Æ‡ßÅ‡¶∏‡¶≤‡¶ø‡¶Æ, ‡ß®‡ß´‡ß¨‡ß™", text: "‡¶ú‡ßÅ‡¶≤‡ßÅ‡¶Æ ‡¶ï‡¶∞‡¶æ ‡¶•‡ßá‡¶ï‡ßá ‡¶¨‡¶ø‡¶∞‡¶§ ‡¶•‡¶æ‡¶ï‡ßã‡•§ ‡¶ï‡ßá‡¶®‡¶®‡¶æ ‡¶ú‡ßÅ‡¶≤‡ßÅ‡¶Æ ‡¶ï‡¶ø‡ßü‡¶æ‡¶Æ‡¶§‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® ‡¶ò‡¶® ‡¶Ö‡¶®‡ßç‡¶ß‡¶ï‡¶æ‡¶∞ ‡¶π‡ßü‡ßá ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡¶¨‡ßá‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß®:‡ßß‡ßØ‡ß´)", text: "‡¶Ü‡¶∞ ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶∞ ‡¶™‡¶•‡ßá ‡¶¨‡ßç‡¶Ø‡ßü ‡¶ï‡¶∞‡ßã ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶ú‡ßá‡¶¶‡ßá‡¶∞ ‡¶π‡¶æ‡¶§‡ßá ‡¶®‡¶ø‡¶ú‡ßá‡¶¶‡ßá‡¶∞‡¶ï‡ßá ‡¶ß‡ßç‡¶¨‡¶Ç‡¶∏‡ßá ‡¶®‡¶ø‡¶™‡¶§‡¶ø‡¶§ ‡¶ï‡¶∞‡ßã ‡¶®‡¶æ‡•§ ‡¶Ü‡¶∞ ‡¶∏‡ßé‡¶ï‡¶∞‡ßç‡¶Æ ‡¶ï‡¶∞‡ßã‡•§ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶∏‡ßé‡¶ï‡¶∞‡ßç‡¶Æ‡¶∂‡ßÄ‡¶≤‡¶¶‡ßá‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã‡¶¨‡¶æ‡¶∏‡ßá‡¶®‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ß¨‡ß¶‡ßß‡ß©", text: "‡¶Ü‡¶§‡ßç‡¶Æ‡ßÄ‡¶Ø‡¶º‡¶§‡¶æ‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï ‡¶õ‡¶ø‡¶®‡ßç‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶ú‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶§‡ßá ‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡¶¨‡ßá ‡¶®‡¶æ‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß´‡ßØ:‡ßß‡ßÆ)", text: "‡¶π‡ßá ‡¶Æ‡ßÅ‡¶Æ‡¶ø‡¶®‡¶ó‡¶£! ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶ï‡ßá ‡¶≠‡ßü ‡¶ï‡¶∞‡ßã ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶§‡ßç‡¶Ø‡ßá‡¶ï‡ßá‡¶á ‡¶Ø‡ßá‡¶® ‡¶≤‡¶ï‡ßç‡¶∑‡ßç‡¶Ø ‡¶ï‡¶∞‡ßá ‡¶Ø‡ßá, ‡¶Ü‡¶ó‡¶æ‡¶Æ‡ßÄ‡¶ï‡¶æ‡¶≤‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶∏‡ßá ‡¶ï‡ßÄ ‡¶™‡ßç‡¶∞‡¶∏‡ßç‡¶§‡ßÅ‡¶§‡¶ø ‡¶®‡¶ø‡ßü‡ßá‡¶õ‡ßá‡•§" },
            { source: "‡¶ú‡¶æ‡¶Æ‡ßá ‡¶§‡¶ø‡¶∞‡¶Æ‡¶ø‡¶ú‡¶ø, ‡ßß‡ßØ‡ß´‡ß¨", text: "‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø ‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá ‡¶®‡¶æ, ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶§‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶Ö‡¶®‡ßÅ‡¶ó‡ßç‡¶∞‡¶π ‡¶ï‡¶∞‡ßá‡¶® ‡¶®‡¶æ‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß®:‡ßß‡ß´‡ß©)", text: "‡¶π‡ßá ‡¶Æ‡ßÅ‡¶Æ‡¶ø‡¶®‡¶ó‡¶£! ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶ß‡ßà‡¶∞‡ßç‡¶Ø ‡¶ì ‡¶∏‡¶æ‡¶≤‡¶æ‡¶§‡ßá‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶™‡ßç‡¶∞‡¶æ‡¶∞‡ßç‡¶•‡¶®‡¶æ ‡¶ï‡¶∞‡ßã‡•§ ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßü ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶ß‡ßà‡¶∞‡ßç‡¶Ø‡¶∂‡ßÄ‡¶≤‡¶¶‡ßá‡¶∞ ‡¶∏‡¶æ‡¶•‡ßá ‡¶Ü‡¶õ‡ßá‡¶®‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ß¨‡ßß‡ß©‡ß©", text: "‡¶Æ‡ßÅ‡¶Æ‡¶ø‡¶® ‡¶è‡¶ï ‡¶ó‡¶∞‡ßç‡¶§‡ßá ‡¶¶‡ßÅ‡¶á‡¶¨‡¶æ‡¶∞ ‡¶¶‡¶Ç‡¶∂‡¶ø‡¶§ ‡¶π‡ßü ‡¶®‡¶æ‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß©‡ßß:‡ßß‡ßØ)", text: "‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶™‡¶¶‡¶ö‡¶æ‡¶∞‡¶£‡¶æ‡ßü ‡¶Æ‡¶ß‡ßç‡¶Ø‡¶Æ‡¶™‡¶®‡ßç‡¶•‡¶æ ‡¶Ö‡¶¨‡¶≤‡¶Æ‡ßç‡¶¨‡¶® ‡¶ï‡¶∞‡ßã ‡¶è‡¶¨‡¶Ç ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ï‡¶£‡ßç‡¶†‡¶∏‡ßç‡¶¨‡¶∞ ‡¶®‡¶ø‡¶ö‡ßÅ ‡¶ï‡¶∞‡ßã‡•§" },
            { source: "‡¶∏‡ßÅ‡¶®‡¶æ‡¶®‡ßá ‡¶Ü‡¶¨‡ßÅ ‡¶¶‡¶æ‡¶â‡¶¶, ‡ß™‡ßÆ‡ß©‡ß®", text: "‡¶Æ‡ßÅ‡¶Æ‡¶ø‡¶®‡¶¶‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶à‡¶Æ‡¶æ‡¶®‡ßá ‡¶™‡¶∞‡¶ø‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶∏‡ßá‡¶á ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø, ‡¶Ø‡¶æ‡¶∞ ‡¶ö‡¶∞‡¶ø‡¶§‡ßç‡¶∞ ‡¶∏‡¶¨‡¶ö‡ßá‡ßü‡ßá ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß©:‡ßß‡ßÆ‡ß´)", text: "‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ü‡¶ø ‡¶™‡ßç‡¶∞‡¶æ‡¶£‡ßÄ‡¶ï‡ßá‡¶á ‡¶Æ‡ßÉ‡¶§‡ßç‡¶Ø‡ßÅ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶¶ ‡¶ó‡ßç‡¶∞‡¶π‡¶£ ‡¶ï‡¶∞‡¶§‡ßá ‡¶π‡¶¨‡ßá‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ß¨‡ß´‡ß¨‡ß¶", text: "‡¶ú‡¶æ‡¶π‡¶æ‡¶®‡ßç‡¶®‡¶æ‡¶Æ‡¶ï‡ßá ‡¶≠‡ßü ‡¶ï‡¶∞‡ßã, ‡¶Ø‡¶¶‡¶ø‡¶ì ‡¶§‡¶æ ‡¶ñ‡ßá‡¶ú‡ßÅ‡¶∞‡ßá‡¶∞ ‡¶è‡¶ï ‡¶ü‡ßÅ‡¶ï‡¶∞‡ßã ‡¶¶‡¶æ‡¶® ‡¶ï‡¶∞‡¶æ‡¶∞ ‡¶Æ‡¶æ‡¶ß‡ßç‡¶Ø‡¶Æ‡ßá ‡¶π‡ßü‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ß™‡ß¶:‡ß¨‡ß¶)", text: "‡¶§‡ßã‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∞‡¶¨ ‡¶¨‡¶≤‡ßá‡¶®, ‚Äò‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶Æ‡¶æ‡¶ï‡ßá ‡¶°‡¶æ‡¶ï‡ßã, ‡¶Ü‡¶Æ‡¶ø ‡¶§‡ßã‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶°‡¶æ‡¶ï‡ßá ‡¶∏‡¶æ‡ßú‡¶æ ‡¶¶‡ßá‡¶¨‚Äô‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶Æ‡ßÅ‡¶∏‡¶≤‡¶ø‡¶Æ, ‡ß®‡ß¨‡ßØ‡ßØ", text: "‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø ‡¶ï‡ßã‡¶®‡ßã ‡¶Æ‡ßÅ‡¶∏‡¶≤‡¶ø‡¶Æ‡ßá‡¶∞ ‡¶¶‡ßã‡¶∑ ‡¶ó‡ßã‡¶™‡¶® ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá, ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶ï‡¶ø‡ßü‡¶æ‡¶Æ‡¶§‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® ‡¶§‡¶æ‡¶∞ ‡¶¶‡ßã‡¶∑ ‡¶ó‡ßã‡¶™‡¶® ‡¶∞‡¶æ‡¶ñ‡¶¨‡ßá‡¶®‡•§" },
            { source: "‡¶Ü‡¶≤-‡¶ï‡ßÅ‡¶∞‡¶Ü‡¶® (‡ßÆ:‡ß™‡ß¨)", text: "‡¶Ü‡¶∞ ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶ì ‡¶§‡¶æ‡¶Å‡¶∞ ‡¶∞‡¶æ‡¶∏‡ßÇ‡¶≤‡ßá‡¶∞ ‡¶Ü‡¶®‡ßÅ‡¶ó‡¶§‡ßç‡¶Ø ‡¶ï‡¶∞‡ßã ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶ú‡ßá‡¶¶‡ßá‡¶∞ ‡¶Æ‡¶ß‡ßç‡¶Ø‡ßá ‡¶¨‡¶ø‡¶¨‡¶æ‡¶¶ ‡¶ï‡¶∞‡ßã ‡¶®‡¶æ, ‡¶§‡¶æ‡¶π‡¶≤‡ßá ‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶∏‡¶æ‡¶π‡¶∏ ‡¶π‡¶æ‡¶∞‡¶æ‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç ‡¶§‡ßã‡¶Æ‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∂‡¶ï‡ßç‡¶§‡¶ø ‡¶¨‡¶ø‡¶≤‡ßÅ‡¶™‡ßç‡¶§ ‡¶π‡¶¨‡ßá‡•§" },
            { source: "‡¶∏‡¶π‡ßÄ‡¶π ‡¶¨‡ßÅ‡¶ñ‡¶æ‡¶∞‡ßÄ, ‡ß¨‡ß™‡ßß‡ß¨", text: "‡¶§‡ßã‡¶Æ‡¶∞‡¶æ ‡¶¶‡ßÅ‡¶®‡¶ø‡¶Ø‡¶º‡¶æ‡¶§‡ßá ‡¶è‡¶Æ‡¶®‡¶≠‡¶æ‡¶¨‡ßá ‡¶¨‡¶∏‡¶¨‡¶æ‡¶∏ ‡¶ï‡¶∞‡ßã ‡¶Ø‡ßá‡¶® ‡¶§‡ßÅ‡¶Æ‡¶ø ‡¶è‡¶ï‡¶ú‡¶® ‡¶Ö‡¶™‡¶∞‡¶ø‡¶ö‡¶ø‡¶§ ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø ‡¶ï‡¶ø‡¶Ç‡¶¨‡¶æ ‡¶™‡¶•‡¶ø‡¶ï‡•§" }
        ];

        // --- COMPONENTS SECTION ---

        // Dashboard Component
        const Dashboard = ({ stats, inboxCount, totalJournalCount, onNavigate, darkMode, toggleTheme }) => {
            const nextLevelNeki = stats.level * LEVEL_THRESHOLD;
            const progress = ((stats.totalNeki - ((stats.level - 1) * LEVEL_THRESHOLD)) / LEVEL_THRESHOLD) * 100;
            const levelProgress = Math.min(Math.max((stats.totalNeki % LEVEL_THRESHOLD) / LEVEL_THRESHOLD * 100, 0), 100);

            return (
                <div className="p-4 space-y-6">
                <div className="flex justify-between items-center py-2">
                    <div>
                        <h2 className="text-4xl font-extrabold text-islamic-600 dark:text-islamic-500 tracking-wide font-serif drop-shadow-sm">‡¶Ü‡¶Æ‡¶≤</h2>
                    </div>
                    <div className="flex gap-3">
                        <button onClick={() => onNavigate(View.INBOX)} className="relative p-2 rounded-full bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700">
                            <Mail size={20} className="text-slate-600 dark:text-slate-300" />
                            {inboxCount > 0 && <span className="absolute top-0 right-0 w-3 h-3 bg-red-500 rounded-full border-2 border-white dark:border-slate-800"></span>}
                        </button>
                        <button onClick={toggleTheme} className="p-2 rounded-full bg-white dark:bg-slate-800 shadow-sm border border-slate-100 dark:border-slate-700">
                            {darkMode ? <Sun size={20} className="text-amber-400" /> : <Moon size={20} className="text-slate-600" />}
                        </button>
                    </div>
                </div>

                <div className="bg-white dark:bg-slate-800 rounded-2xl p-4 shadow-sm border border-slate-100 dark:border-slate-700">
                    <div className="flex justify-between text-sm mb-2 font-semibold">
                        <span className="text-islamic-600 dark:text-islamic-400">‡¶≤‡ßá‡¶≠‡ßá‡¶≤ {stats.level}</span>
                        <span className="text-slate-400">{Math.floor(levelProgress)}%</span>
                    </div>
                    <div className="h-2 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden">
                        <div className="h-full bg-gradient-to-r from-islamic-500 to-emerald-400 transition-all duration-1000" style={{ width: `${levelProgress}%` }}></div>
                    </div>
                    <div className="text-xs text-slate-400 mt-1 text-right">{stats.totalNeki % LEVEL_THRESHOLD} / {LEVEL_THRESHOLD} ‡¶®‡ßá‡¶ï‡¶ø</div>
                </div>

                <div className="grid grid-cols-2 gap-4">
                    <div className="bg-gradient-to-br from-islamic-500 to-islamic-600 dark:from-islamic-900 dark:to-emerald-950 dark:border dark:border-islamic-800/50 rounded-2xl p-4 text-white shadow-lg shadow-islamic-500/20 dark:shadow-none">
                        <div className="flex justify-between items-start mb-2">
                            <div className="text-islamic-100 text-xs font-medium">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶®‡ßá‡¶ï‡¶ø</div>
                            <div className="text-islamic-100 dark:text-islamic-300 text-[10px] bg-white/20 dark:bg-black/20 px-1.5 rounded">Total</div>
                        </div>
                        <div className="flex items-end gap-2">
                            <div className="text-3xl font-bold">{stats.todayNeki}</div>
                        </div>
                        <div className="mt-2 pt-2 border-t border-white/20 dark:border-white/10 flex flex-col">
                            <div className="text-[10px] text-islamic-100 opacity-80">‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü ‡¶®‡ßá‡¶ï‡¶ø</div>
                            <div className="text-xl font-bold tracking-wide">{stats.totalNeki}</div>
                        </div>
                    </div>

                    <div className="bg-gradient-to-br from-sky-400 to-blue-500 dark:from-sky-900 dark:to-blue-950 dark:border dark:border-sky-800/50 rounded-2xl p-4 text-white shadow-lg shadow-sky-400/20 dark:shadow-none flex flex-col justify-between">
                        <div>
                            <div className="text-blue-50 dark:text-sky-200 text-xs font-medium mb-1">‡¶Æ‡ßã‡¶ü XP</div>
                            <div className="text-2xl font-bold text-white">
                                {stats.totalXP}
                            </div>
                        </div>
                        
                        <div className="mt-2 pt-2 border-t border-white/20 dark:border-white/10">
                            <div className="flex justify-between items-end">
                                <div>
                                    <div className="text-[10px] text-blue-50 opacity-80">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶ú‡¶æ‡¶∞‡ßç‡¶®‡¶æ‡¶≤</div>
                                    <div className="text-lg font-bold">{stats.todayJournalCount} ‡¶ü‡¶ø</div>
                                </div>
                                <div className="text-right">
                                    <div className="text-[10px] text-blue-50 opacity-80">‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü</div>
                                    <div className="text-lg font-bold">{totalJournalCount} ‡¶ü‡¶ø</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div className="space-y-4">
                    <h3 className="font-bold text-slate-700 dark:text-slate-300">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶≤</h3>
                    
                    <div onClick={() => onNavigate(View.TASBIH_LIST)} className="bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 flex items-center gap-4 cursor-pointer active:scale-95 transition-transform group">
                        <div className="w-12 h-12 rounded-full bg-blue-50 dark:bg-blue-900/30 flex items-center justify-center text-blue-500 dark:text-blue-400 group-hover:bg-blue-100 transition-colors">
                            <Fingerprint size={24} />
                        </div>
                        <div className="flex-1">
                            <h4 className="font-bold text-slate-800 dark:text-slate-100">‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π</h4>
                            <p className="text-xs text-slate-500 dark:text-slate-400">‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶∞ ‡¶ú‡¶ø‡¶ï‡¶ø‡¶∞ ‡¶¶‡¶ø‡¶Ø‡¶º‡ßá ‡¶¶‡¶ø‡¶® ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®</p>
                        </div>
                        <div className="w-8 h-8 rounded-full bg-slate-50 dark:bg-slate-700 flex items-center justify-center group-hover:bg-islamic-50 group-hover:text-islamic-600 transition-all">
                            <span className="text-islamic-600 dark:text-islamic-400 font-bold text-xs">GO</span>
                        </div>
                    </div>

                    <div onClick={() => onNavigate(View.TARGET_LIST)} className="bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 flex items-center gap-4 cursor-pointer active:scale-95 transition-transform">
                        <div className="w-12 h-12 rounded-full bg-purple-50 dark:bg-purple-900/30 flex items-center justify-center text-purple-500 dark:text-purple-400">
                            <ClipboardCheck size={24} />
                        </div>
                        <div className="flex-1">
                            <h4 className="font-bold text-slate-800 dark:text-slate-100">‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶Ü‡¶Æ‡¶≤</h4>
                            <p className="text-xs text-slate-500 dark:text-slate-400">‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶®‡¶ø‡¶∞‡ßç‡¶ß‡¶æ‡¶∞‡¶ø‡¶§ ‡¶Ü‡¶Æ‡¶≤‡¶∏‡¶Æ‡ßÇ‡¶π</p>
                        </div>
                    </div>
                </div>
                </div>
            );
        };

        // TasbihList Component
        const TasbihList = ({ tasbihs, onBack, onSelect, onAdd, onEdit, onDelete }) => {
            const [showModal, setShowModal] = useState(false);
            const [showManager, setShowManager] = useState(false);
            
            const [editingId, setEditingId] = useState(null);
            const [name, setName] = useState('');
            const [arabicText, setArabicText] = useState('');
            const [banglaMeaning, setBanglaMeaning] = useState('');
            const [manualNeki, setManualNeki] = useState('');
            const [scheduleType, setScheduleType] = useState('everyday');
            const [selectedDays, setSelectedDays] = useState([]);

            const toggleDay = (day) => {
                if (selectedDays.includes(day)) {
                    setSelectedDays(selectedDays.filter(d => d !== day));
                } else {
                    setSelectedDays([...selectedDays, day]);
                }
            };

            const openAddModal = () => {
                resetForm();
                setEditingId(null);
                setShowModal(true);
            };

            const openEditModal = (t) => {
                setEditingId(t.id);
                setName(t.name);
                setArabicText(t.arabicText || '');
                setBanglaMeaning(t.banglaMeaning || '');
                setManualNeki(t.manualNeki ? t.manualNeki.toString() : '');
                setScheduleType(Array.isArray(t.schedule) ? 'custom' : 'everyday');
                setSelectedDays(Array.isArray(t.schedule) ? t.schedule : []);
                setShowModal(true);
            };

            const handleSave = () => {
                if (!name.trim()) return;

                const tasbihData = {
                    id: editingId || Date.now().toString(),
                    name,
                    arabicText: arabicText.trim() || undefined,
                    banglaMeaning: banglaMeaning.trim() || undefined,
                    manualNeki: manualNeki ? parseInt(manualNeki) : undefined,
                    schedule: scheduleType === 'everyday' ? 'everyday' : selectedDays,
                    count: editingId ? tasbihs.find(t => t.id === editingId)?.count || 0 : 0,
                    totalCount: editingId ? tasbihs.find(t => t.id === editingId)?.totalCount || 0 : 0,
                    todayTime: editingId ? tasbihs.find(t => t.id === editingId)?.todayTime || 0 : 0
                };

                if (editingId) {
                    onEdit(tasbihData);
                } else {
                    onAdd(tasbihData);
                }
                
                resetForm();
                setShowModal(false);
            };

            const resetForm = () => {
                setName('');
                setArabicText('');
                setBanglaMeaning('');
                setManualNeki('');
                setScheduleType('everyday');
                setSelectedDays([]);
                setEditingId(null);
            };

            const confirmDelete = (id) => {
                toast((t) => (
                <div className="w-full">
                    <p className="font-bold text-lg text-slate-800 mb-4">‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶Ü‡¶Æ‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶¨‡¶æ‡¶¶ ‡¶¶‡¶ø‡¶§‡ßá ‡¶ö‡¶æ‡¶®?</p>
                    <div className="flex justify-end gap-3">
                        <button 
                            onClick={() => toast.dismiss(t.id)}
                            className="px-4 py-2 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200 transition-colors"
                        >
                            ‡¶®‡¶æ
                        </button>
                        <button 
                            onClick={() => {
                                onDelete(id);
                                toast.dismiss(t.id);
                                toast.success('‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
                            }}
                            className="px-4 py-2 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors"
                        >
                            ‡¶π‡ßç‡¶Ø‡¶æ‡¶Å
                        </button>
                    </div>
                </div>
                ), {
                    duration: 5000,
                    position: 'top-center',
                    style: {
                        background: '#fff',
                        color: '#1e293b',
                        border: '1px solid #e2e8f0',
                        padding: '24px',
                        borderRadius: '20px',
                        minWidth: '340px',
                        maxWidth: '90vw'
                    }
                });
            };

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-night-900 pb-24">
                <div className="bg-white dark:bg-night-800 p-4 sticky top-0 z-10 shadow-sm flex items-center justify-between">
                    <button onClick={onBack} className="p-2 -ml-2 text-slate-600 dark:text-slate-300">
                    <ChevronLeft />
                    </button>
                    <h2 className="font-bold text-lg dark:text-white">‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ</h2>
                    <div className="flex gap-2">
                        <button onClick={() => setShowManager(true)} className="p-2 text-slate-500 hover:text-islamic-600 transition-colors">
                            <FolderCog size={20} />
                        </button>
                        <button onClick={openAddModal} className="p-2 text-islamic-600 font-medium text-sm flex items-center gap-1 bg-islamic-50 dark:bg-islamic-900/30 rounded-lg">
                            <Plus size={18} /> ‡¶Ø‡ßã‡¶ó
                        </button>
                    </div>
                </div>

                <div className="p-4 space-y-3">
                    {tasbihs.map((t) => (
                    <div key={t.id} className="bg-white dark:bg-night-800 rounded-xl p-4 shadow-sm border border-slate-100 dark:border-slate-800 relative group active:scale-[0.99] transition-transform cursor-pointer" onClick={() => onSelect(t.id)}>
                        <div className="flex justify-between items-start mb-2">
                            <div className="flex-1">
                                <h3 className="font-bold text-slate-800 dark:text-slate-100 text-lg">{t.name}</h3>
                                {t.arabicText && <p className="text-islamic-600 dark:text-islamic-400 font-serif text-xl mt-1 leading-relaxed">{t.arabicText}</p>}
                                {t.banglaMeaning && <p className="text-slate-500 dark:text-slate-400 text-xs mt-1 italic">{t.banglaMeaning}</p>}
                            </div>
                            <div className="text-xs bg-slate-100 dark:bg-slate-700 px-2 py-1 rounded-md text-slate-500 dark:text-slate-300 ml-2 whitespace-nowrap">
                                {Array.isArray(t.schedule) ? 'Custom Days' : '‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶®'}
                            </div>
                        </div>
                        <div className="mt-3 flex items-center gap-2">
                                <span className="text-xs font-bold text-islamic-700 dark:text-islamic-300 bg-islamic-50 dark:bg-islamic-900/30 px-2 py-1 rounded">
                                ‡¶Ü‡¶ú: {t.count} ‡¶¨‡¶æ‡¶∞
                                </span>
                        </div>
                    </div>
                    ))}
                    {tasbihs.length === 0 && (
                        <div className="text-center py-10 text-slate-400">
                            ‡¶ï‡ßã‡¶®‡ßã ‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶®‡ßá‡¶á‡•§ '‡¶Ø‡ßã‡¶ó' ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§
                        </div>
                    )}
                </div>

                {showManager && (
                    <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
                        <div className="bg-white dark:bg-night-800 rounded-2xl w-full max-w-sm shadow-xl flex flex-col max-h-[80vh] border dark:border-slate-700">
                            <div className="p-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center">
                                <h3 className="font-bold text-lg dark:text-white flex items-center gap-2"><FolderCog size={20}/> ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶æ‡¶∞</h3>
                                <button onClick={() => setShowManager(false)} className="p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-500"><X size={20}/></button>
                            </div>
                            <div className="overflow-y-auto p-2 space-y-2">
                                {tasbihs.map(t => (
                                    <div key={t.id} className="flex items-center justify-between p-3 bg-slate-50 dark:bg-black rounded-xl border border-slate-200 dark:border-slate-700">
                                        <span className="font-medium text-slate-700 dark:text-slate-200 truncate pr-2">{t.name}</span>
                                        <div className="flex gap-2">
                                            <button 
                                                onClick={() => { setShowManager(false); openEditModal(t); }} 
                                                className="p-2 bg-blue-50 dark:bg-blue-900/20 text-blue-600 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/40"
                                            >
                                                <Pencil size={16} />
                                            </button>
                                            <button 
                                                onClick={() => confirmDelete(t.id)} 
                                                className="p-2 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/40"
                                            >
                                                <Trash2 size={16} />
                                            </button>
                                        </div>
                                    </div>
                                ))}
                                {tasbihs.length === 0 && <p className="text-center text-slate-400 py-4">‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶ñ‡¶æ‡¶≤‡¶ø</p>}
                            </div>
                        </div>
                    </div>
                )}

                {showModal && (
                    <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm overflow-y-auto">
                    <div className="bg-white dark:bg-night-800 rounded-2xl p-6 w-full max-w-sm shadow-xl max-h-[90vh] overflow-y-auto no-scrollbar border dark:border-slate-700">
                        <h3 className="text-lg font-bold mb-4 dark:text-white">{editingId ? '‡¶Ü‡¶Æ‡¶≤ ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®' : '‡¶®‡¶§‡ßÅ‡¶® ‡¶Ü‡¶Æ‡¶≤ ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®'}</h3>
                        
                        <div className="space-y-4">
                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-1">‡¶Ü‡¶Æ‡¶≤‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ (‡¶Ü‡¶¨‡¶∂‡ßç‡¶Ø‡¶ï)</label>
                                <input 
                                type="text" 
                                placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶∏‡ßÅ‡¶¨‡¶π‡¶æ‡¶®‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶π" 
                                className="w-full p-3 rounded-xl border border-slate-200 bg-white dark:border-slate-700 dark:bg-black dark:text-white"
                                value={name}
                                onChange={e => setName(e.target.value)}
                                />
                            </div>

                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-2">‡¶∏‡¶Æ‡¶Ø‡¶º‡¶∏‡ßÇ‡¶ö‡¶ø</label>
                                <div className="flex gap-2 mb-2 bg-slate-100 dark:bg-black p-1 rounded-lg">
                                    <button 
                                        className={`flex-1 py-1.5 text-xs font-bold rounded-md transition-colors ${scheduleType === 'everyday' ? 'bg-white dark:bg-slate-700 shadow-sm text-slate-800 dark:text-white' : 'text-slate-500'}`}
                                        onClick={() => setScheduleType('everyday')}
                                    >‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶®</button>
                                    <button 
                                        className={`flex-1 py-1.5 text-xs font-bold rounded-md transition-colors ${scheduleType === 'custom' ? 'bg-white dark:bg-slate-700 shadow-sm text-slate-800 dark:text-white' : 'text-slate-500'}`}
                                        onClick={() => setScheduleType('custom')}
                                    >‡¶®‡¶ø‡¶∞‡ßç‡¶¶‡¶ø‡¶∑‡ßç‡¶ü ‡¶¶‡¶ø‡¶®</button>
                                </div>
                                
                                {scheduleType === 'custom' && (
                                    <div className="flex flex-wrap gap-2">
                                        {DAYS_OF_WEEK.map(day => (
                                            <button
                                                key={day}
                                                onClick={() => toggleDay(day)}
                                                className={`px-3 py-1 text-xs rounded-full border ${selectedDays.includes(day) ? 'bg-islamic-600 text-white border-islamic-600' : 'bg-white dark:bg-black border-slate-200 dark:border-slate-700 dark:text-slate-300'}`}
                                            >
                                                {day}
                                            </button>
                                        ))}
                                    </div>
                                )}
                            </div>

                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-1">‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)</label>
                                <textarea 
                                placeholder="‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶ü‡ßá‡¶ï‡ßç‡¶∏‡¶ü ‡¶¶‡¶ø‡¶®..." 
                                className="w-full p-3 rounded-xl border border-slate-200 bg-white dark:border-slate-700 dark:bg-black dark:text-white font-serif h-20 resize-none"
                                value={arabicText}
                                onChange={e => setArabicText(e.target.value)}
                                />
                                <p className="text-[10px] text-slate-400 mt-1">‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶¶‡¶ø‡¶≤‡ßá ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶π‡¶∞‡¶´‡ßá ‡ßß‡ß¶ ‡¶®‡ßá‡¶ï‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶π‡¶¨‡ßá‡•§</p>
                            </div>

                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-1">‡¶¨‡¶æ‡¶Ç‡¶≤‡¶æ ‡¶Ö‡¶∞‡ßç‡¶• (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)</label>
                                <input 
                                type="text" 
                                placeholder="‡¶Ö‡¶∞‡ßç‡¶•..." 
                                className="w-full p-3 rounded-xl border border-slate-200 bg-white dark:border-slate-700 dark:bg-black dark:text-white"
                                value={banglaMeaning}
                                onChange={e => setBanglaMeaning(e.target.value)}
                                />
                            </div>

                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-1">‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡¶Ø‡¶º‡¶æ‡¶≤ ‡¶®‡ßá‡¶ï‡¶ø (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)</label>
                                <input 
                                type="number" 
                                placeholder="‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶¨‡¶æ‡¶∞‡ßá ‡¶ï‡¶§ ‡¶®‡ßá‡¶ï‡¶ø?" 
                                className="w-full p-3 rounded-xl border border-slate-200 bg-white dark:border-slate-700 dark:bg-black dark:text-white"
                                value={manualNeki}
                                onChange={e => setManualNeki(e.target.value)}
                                />
                                <p className="text-[10px] text-slate-400 mt-1">‡¶Ü‡¶∞‡¶¨‡¶ø ‡¶®‡¶æ ‡¶¶‡¶ø‡¶≤‡ßá ‡¶è‡¶ñ‡¶æ‡¶® ‡¶•‡ßá‡¶ï‡ßá ‡¶®‡ßá‡¶ï‡¶ø ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨ ‡¶π‡¶¨‡ßá‡•§</p>
                            </div>
                        </div>

                        <div className="flex gap-3 mt-6">
                        <button onClick={() => setShowModal(false)} className="flex-1 py-3 rounded-xl bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 font-semibold">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                        <button onClick={handleSave} className="flex-1 py-3 rounded-xl bg-islamic-600 text-white font-semibold shadow-lg shadow-islamic-600/30">‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£</button>
                        </div>
                    </div>
                    </div>
                )}
                </div>
            );
        };

        // FocusMode Component
        const FocusMode = ({ tasbih, onUpdate, onTimeUpdate, onBack, darkMode }) => {
            const [sessionCount, setSessionCount] = useState(0);
            const [displayCount, setDisplayCount] = useState(tasbih.count);
            const [totalDisplayCount, setTotalDisplayCount] = useState(tasbih.totalCount);
            
            const [particles, setParticles] = useState([]);
            const [isPulsing, setIsPulsing] = useState(false);
            const [isIdle, setIsIdle] = useState(false);
            
            const [duration, setDuration] = useState(tasbih.todayTime || 0); 
            const [isTimerRunning, setIsTimerRunning] = useState(false);

            const pendingIncrementRef = useRef(0);
            const lastSavedCountRef = useRef(tasbih.count);
            const buttonRef = useRef(null);
            const idleTimerRef = useRef(null);
            const onTimeUpdateRef = useRef(onTimeUpdate);
            const onUpdateRef = useRef(onUpdate);

            useEffect(() => { onTimeUpdateRef.current = onTimeUpdate; }, [onTimeUpdate]);
            useEffect(() => { onUpdateRef.current = onUpdate; }, [onUpdate]);

            const flushUpdates = useCallback(() => {
                if (pendingIncrementRef.current > 0) {
                    const newCount = lastSavedCountRef.current + pendingIncrementRef.current;
                    const increment = pendingIncrementRef.current;
                    
                    onUpdateRef.current(newCount, increment);
                    
                    lastSavedCountRef.current = newCount;
                    pendingIncrementRef.current = 0;
                }
            }, []);

            useEffect(() => {
                const interval = setInterval(flushUpdates, 2000); 
                return () => {
                    clearInterval(interval);
                    flushUpdates(); 
                };
            }, [flushUpdates]);

            const handleBack = () => {
                flushUpdates();
                onBack();
            };

            let currentScale = 0;
            if (totalDisplayCount > 0) {
                const progressTo100 = Math.min(totalDisplayCount, 100) / 100;
                currentScale = 0.2 + (Math.pow(progressTo100, 2.5) * 0.8);
            }

            const isTreeLarge = currentScale > 0.5;

            let densityProgress = 0;
            if (totalDisplayCount > 100) {
                const rawDensity = Math.min((totalDisplayCount - 100) / 400, 1);
                densityProgress = Math.pow(rawDensity, 1.5); 
            }
            
            const stars = useMemo(() => {
                return [...Array(40)].map((_, i) => ({
                id: i,
                size: Math.random() * 2 + 1 + 'px',
                top: Math.random() * 100 + '%',
                left: Math.random() * 100 + '%',
                animationDuration: Math.random() * 3 + 2 + 's',
                animationDelay: Math.random() * 2 + 's',
                }));
            }, []);

            useEffect(() => {
                let interval;
                if (isTimerRunning) {
                    interval = setInterval(() => {
                        setDuration(prev => {
                            const newTime = prev + 1;
                            onTimeUpdateRef.current(newTime);
                            return newTime;
                        });
                    }, 1000);
                }
                return () => clearInterval(interval);
            }, [isTimerRunning]);

            const resetIdleTimer = () => {
                setIsIdle(false);
                if (idleTimerRef.current) clearTimeout(idleTimerRef.current);
                idleTimerRef.current = setTimeout(() => {
                    setIsIdle(true);
                    setIsTimerRunning(false); 
                }, 5000); 
            };

            useEffect(() => {
                return () => { if (idleTimerRef.current) clearTimeout(idleTimerRef.current); };
            }, []);

            const handleTap = (e) => {
                if (!isTimerRunning) setIsTimerRunning(true);
                resetIdleTimer();
                
                if (navigator.vibrate) navigator.vibrate(50);
                
                setSessionCount(prev => prev + 1);
                setDisplayCount(prev => prev + 1);
                setTotalDisplayCount(prev => prev + 1);

                pendingIncrementRef.current += 1;

                setIsPulsing(true);
                setTimeout(() => setIsPulsing(false), 150);

                const rect = buttonRef.current?.getBoundingClientRect();
                if (rect) {
                const newParticle = {
                    id: Date.now(),
                    x: rect.left + rect.width / 2,
                    y: rect.top + 20 
                };
                setParticles(prev => {
                    const next = [...prev, newParticle];
                    if (next.length > 15) return next.slice(next.length - 15);
                    return next;
                });
                setTimeout(() => {
                    setParticles(prev => prev.filter(p => p.id !== newParticle.id));
                }, 800);
                }
            };

            const handleManualPause = () => {
                setIsTimerRunning(false);
            };

            const formatTime = (secs) => {
                const m = Math.floor(secs / 60);
                const s = secs % 60;
                return `${m}:${s.toString().padStart(2, '0')}`;
            };

            const FRUIT_POSITIONS = [
                { cx: 150, cy: 50, r: 6 }, { cx: 120, cy: 60, r: 7 }, { cx: 180, cy: 55, r: 6 },
                { cx: 90, cy: 130, r: 5 }, { cx: 210, cy: 110, r: 6 }, { cx: 140, cy: 90, r: 7 },
                { cx: 160, cy: 110, r: 6 }, { cx: 110, cy: 80, r: 5 }, { cx: 190, cy: 75, r: 6 },
                { cx: 70, cy: 90, r: 5 }, { cx: 230, cy: 80, r: 6 }, { cx: 130, cy: 130, r: 5 },
                { cx: 170, cy: 130, r: 6 }, { cx: 100, cy: 110, r: 5 }, { cx: 200, cy: 90, r: 6 },
                { cx: 150, cy: 30, r: 5 }, { cx: 120, cy: 40, r: 5 }, { cx: 180, cy: 40, r: 5 },
                { cx: 80, cy: 110, r: 5 }, { cx: 220, cy: 95, r: 6 }, { cx: 150, cy: 150, r: 6 },
                { cx: 135, cy: 70, r: 7 }, { cx: 165, cy: 70, r: 7 }, { cx: 60, cy: 80, r: 4 },
                { cx: 240, cy: 60, r: 4 }, { cx: 100, cy: 50, r: 5 }, { cx: 200, cy: 50, r: 5 },
                { cx: 150, cy: 75, r: 8 }, { cx: 115, cy: 100, r: 6 }, { cx: 185, cy: 100, r: 6 }
            ];

            const getTreeStyle = () => {
                let mainLeafColor = darkMode ? "#22c55e" : "#4ade80"; 
                let trunkColor = darkMode ? "#5e4b35" : "#8B4513";
                let isMixedLeaves = false;
                let mixedPalette = [];
                let fruitColor = "transparent";
                let visibleFruitCount = 0;
                let isMixedFruit = false;
                let filter = "none";
                
                const total = totalDisplayCount;

                if (total < 500) {
                    if (total >= 100) {
                        const ratio = (total - 100) / 400;
                        const lightness = darkMode ? 50 - (ratio * 20) : 60 - (ratio * 25);
                        const saturation = darkMode ? 60 + (ratio * 10) : 70 + (ratio * 15);
                        mainLeafColor = `hsl(142, ${saturation}%, ${lightness}%)`;
                    }
                }
                else if (total >= 500 && total < 1000) {
                    mainLeafColor = darkMode ? "#fbbf24" : "#facc15"; 
                }
                else if (total >= 1000 && total < 1500) {
                    mainLeafColor = darkMode ? "#ec4899" : "#f472b6"; 
                }
                else if (total >= 1500 && total < 3000) {
                    mainLeafColor = darkMode ? "#ef4444" : "#dc2626"; 
                    visibleFruitCount = Math.min(Math.floor((total - 1500) / 100), FRUIT_POSITIONS.length);
                    fruitColor = "#fcd34d"; 
                }
                else if (total >= 3000 && total < 5000) {
                    isMixedLeaves = true;
                    mixedPalette = darkMode 
                        ? ["#fbbf24", "#ec4899", "#22c55e"] 
                        : ["#facc15", "#f472b6", "#4ade80"];
                    trunkColor = darkMode ? "#4a3b2a" : "#5D4037";
                    visibleFruitCount = FRUIT_POSITIONS.length;
                    fruitColor = "#fff"; 
                    filter = "drop-shadow(0 0 5px rgba(251, 191, 36, 0.4))";
                }
                else if (total >= 5000) {
                    isMixedLeaves = true;
                    mixedPalette = darkMode 
                        ? ["#0ea5e9", "#ef4444", "#fbbf24"]
                        : ["#0ea5e9", "#ef4444", "#fbbf24"]; 
                    trunkColor = "#312e81"; 
                    visibleFruitCount = FRUIT_POSITIONS.length;
                    fruitColor = "#ffffff";
                    isMixedFruit = true;
                    filter = "drop-shadow(0 0 10px rgba(14, 165, 233, 0.5))";
                }

                const getLeafColor = (index) => {
                    if (!isMixedLeaves) return mainLeafColor;
                    return mixedPalette[index % mixedPalette.length];
                };

                const getFruitColor = (index) => {
                    if (isMixedFruit) {
                        const colors = ["#fff", "#fef08a", "#bae6fd"];
                        return colors[index % colors.length];
                    }
                    return fruitColor;
                };

                return { trunkColor, filter, getLeafColor, getFruitColor, visibleFruitCount };
            };

            const { trunkColor, filter, getLeafColor, getFruitColor, visibleFruitCount } = getTreeStyle();

            return (
                <div className={`fixed inset-0 w-full h-full flex flex-col overflow-hidden ${darkMode ? 'bg-night-900' : 'bg-gradient-to-b from-sky-200 via-sky-100 to-emerald-50'}`}>
                
                <style>{`
                    @keyframes sway {
                        0% { transform: rotate(-1deg); }
                        50% { transform: rotate(1deg); }
                        100% { transform: rotate(-1deg); }
                    }
                    @keyframes shimmer {
                        0% { opacity: 0.9; }
                        50% { opacity: 1; }
                        100% { opacity: 0.9; }
                    }
                    @keyframes twinkle {
                        0%, 100% { opacity: 0.3; transform: scale(0.8); }
                        50% { opacity: 1; transform: scale(1.1); }
                    }
                    @keyframes flyParticle {
                        0% { transform: translate(-50%, 0) scale(1); opacity: 1; }
                        100% { transform: translate(-50%, -220px) scale(0.2); opacity: 0; }
                    }
                    @keyframes idleRedPulse {
                        0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); border-color: rgba(239, 68, 68, 0.7); }
                        70% { box-shadow: 0 0 0 20px rgba(239, 68, 68, 0); border-color: rgba(239, 68, 68, 0.1); }
                        100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); border-color: rgba(239, 68, 68, 0); }
                    }
                    @keyframes fruitPop {
                        0% { transform: scale(0); }
                        60% { transform: scale(1.2); }
                        100% { transform: scale(1); }
                    }
                `}</style>

                <div className="absolute inset-0 overflow-hidden pointer-events-none z-0">
                    {darkMode ? (
                        <>
                            {stars.map((star) => (
                                <div key={star.id} className="absolute bg-white rounded-full" 
                                    style={{ 
                                        width: star.size, 
                                        height: star.size, 
                                        top: star.top, 
                                        left: star.left,
                                        animation: `twinkle ${star.animationDuration} infinite ease-in-out`,
                                        animationDelay: star.animationDelay
                                    }} 
                                />
                            ))}
                            <div className="absolute top-16 right-8 w-16 h-16 rounded-full shadow-[-8px_4px_0_2px_#fff] rotate-[-25deg] opacity-90 drop-shadow-[0_0_15px_rgba(255,255,255,0.4)]"></div>
                        </>
                    ) : (
                        <div className="absolute top-[-50px] right-[-50px] w-64 h-64 bg-yellow-300 rounded-full blur-[80px] opacity-40"></div>
                    )}
                </div>

                <div className="absolute top-0 left-0 w-full z-50 p-4 flex justify-between items-center text-slate-800 dark:text-white">
                    <button onClick={handleBack} className="p-2 bg-white/20 dark:bg-white/10 backdrop-blur-md rounded-full active:scale-95 transition-transform"><ChevronLeft /></button>
                </div>

                <div 
                    className="absolute left-0 w-full z-40 flex flex-col items-center justify-start px-6 text-center transition-all duration-700 ease-in-out"
                    style={{
                        top: isTreeLarge ? '16px' : '48px',
                        transform: isTreeLarge ? 'scale(0.85)' : 'scale(1)',
                        opacity: 1
                    }}
                >
                    {tasbih.arabicText && (
                            <div className="text-2xl md:text-3xl font-serif text-islamic-800 dark:text-islamic-100 drop-shadow-sm leading-normal animate-fade-in py-1">
                                {tasbih.arabicText}
                            </div>
                        )}
                        <div className="bg-white/30 dark:bg-night-800/60 backdrop-blur-md rounded-xl py-1 px-3 inline-block border border-white/40 dark:border-white/10 shadow-sm">
                            <h2 className="text-base text-slate-800 dark:text-slate-100 font-bold">{tasbih.name}</h2>
                            {tasbih.banglaMeaning && <p className="text-[10px] text-slate-700 dark:text-slate-300">{tasbih.banglaMeaning}</p>}
                        </div>
                </div>

                <div className="absolute inset-0 z-20 flex items-end justify-center pb-52 pointer-events-none">
                        
                        {particles.map(p => (
                            <div 
                                key={p.id}
                                className="absolute w-4 h-4 rounded-full z-10"
                                style={{
                                    left: '50%', 
                                    bottom: '50px',
                                    backgroundColor: '#4ade80',
                                    boxShadow: '0 0 10px currentColor',
                                    animation: 'flyParticle 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94) forwards'
                                }}
                            />
                        ))}

                        <div className={`absolute bottom-0 w-80 h-16 rounded-[100%] blur-md transition-colors duration-1000 ${darkMode ? 'bg-night-800' : 'bg-emerald-700/20'}`}></div>
                        
                        {totalDisplayCount > 0 && (
                            <div 
                                className="transition-transform duration-500 ease-out will-change-transform origin-bottom mb-4 z-20"
                                style={{
                                    transform: `scale(${currentScale}) ${isPulsing ? 'scale(1.03)' : ''}`,
                                    filter: filter,
                                    height: '320px',
                                    width: '320px'
                                }}
                            >
                                <svg 
                                    viewBox="0 0 300 300" 
                                    className="w-full h-full drop-shadow-2xl overflow-visible"
                                >
                                    <g transform-origin="150 280" style={{ animation: 'sway 6s ease-in-out infinite' }}>
                                        
                                        <path 
                                            d="M150,280 Q160,200 145,150 T150,50" 
                                            stroke={trunkColor} 
                                            strokeWidth="18" 
                                            fill="none" 
                                            strokeLinecap="round"
                                            className="transition-colors duration-1000"
                                        />
                                        
                                        <path d="M150,280 Q130,290 120,300" stroke={trunkColor} strokeWidth="12" fill="none" strokeLinecap="round" className="transition-colors duration-1000"/>
                                        <path d="M150,280 Q170,290 180,300" stroke={trunkColor} strokeWidth="12" fill="none" strokeLinecap="round" className="transition-colors duration-1000"/>

                                        <g stroke={trunkColor} fill="none" strokeLinecap="round" className="transition-colors duration-1000">
                                            <path d="M148,180 Q110,160 90,130" strokeWidth="12" />
                                            <path d="M152,160 Q190,140 210,110" strokeWidth="11" />
                                        </g>

                                        <g stroke={trunkColor} fill="none" strokeLinecap="round" opacity={densityProgress} className="transition-opacity duration-1000">
                                            <path d="M90,130 Q70,110 60,80" strokeWidth="8" />
                                            <path d="M210,110 Q230,90 240,60" strokeWidth="8" />
                                            <path d="M148,110 Q120,90 110,60" strokeWidth="8" />
                                            <path d="M152,100 Q180,80 190,50" strokeWidth="8" />
                                        </g>
                                        
                                        <g style={{ animation: 'shimmer 3s ease-in-out infinite' }}>
                                            <circle cx="150" cy="50" r="45" opacity="0.95" fill={getLeafColor(0)} />
                                            <circle cx="90" cy="130" r="35" opacity="0.9" fill={getLeafColor(1)} />
                                            <circle cx="210" cy="110" r="38" opacity="0.9" fill={getLeafColor(2)} />
                                            <circle cx="120" cy="60" r="35" opacity="0.85" fill={getLeafColor(3)} />
                                            <circle cx="180" cy="55" r="38" opacity="0.85" fill={getLeafColor(4)} />

                                            <g opacity={Math.min(densityProgress + 0.2, 1)}>
                                                <circle cx="60" cy="80" r="32" opacity="0.95" fill={getLeafColor(5)} />
                                                <circle cx="240" cy="60" r="34" opacity="0.95" fill={getLeafColor(6)} />
                                                <circle cx="110" cy="60" r="30" opacity="0.9" fill={getLeafColor(7)} />
                                                <circle cx="190" cy="50" r="30" opacity="0.9" fill={getLeafColor(8)} />
                                            </g>

                                            <g opacity={densityProgress}>
                                                <circle cx="150" cy="80" r="40" opacity="0.8" fill={getLeafColor(9)} />
                                                <circle cx="85" cy="100" r="28" opacity="0.85" fill={getLeafColor(10)} />
                                                <circle cx="215" cy="80" r="30" opacity="0.85" fill={getLeafColor(11)} />
                                                <circle cx="130" cy="30" r="25" opacity="0.9" fill={getLeafColor(12)} />
                                                <circle cx="170" cy="30" r="25" opacity="0.9" fill={getLeafColor(13)} />
                                            </g>
                                        </g>

                                        {visibleFruitCount > 0 && (
                                            <g className="transition-colors duration-1000" style={{ animation: 'shimmer 2s infinite alternate' }}>
                                                {FRUIT_POSITIONS.slice(0, visibleFruitCount).map((pos, index) => (
                                                    <circle 
                                                        key={index}
                                                        cx={pos.cx} 
                                                        cy={pos.cy} 
                                                        r={pos.r} 
                                                        fill={getFruitColor(index)}
                                                        style={{ animation: `fruitPop 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards`, transformOrigin: `${pos.cx}px ${pos.cy}px` }}
                                                    />
                                                ))}
                                            </g>
                                        )}
                                    </g>
                                </svg>
                            </div>
                        )}
                </div>

                <div className="absolute bottom-0 left-0 w-full z-50 pb-2 px-4">
                        
                        <p className="text-center text-[10px] text-slate-500 dark:text-slate-500 font-medium tracking-wide mb-2 opacity-60 h-4">
                            {isIdle && <span className="text-red-500 font-bold animate-pulse">‡¶∏‡ßç‡¶Æ‡¶∞‡¶£ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶ì ‡¶ü‡ßç‡¶Ø‡¶æ‡¶™ ‡¶ï‡¶∞‡ßÅ‡¶®</span>}
                        </p>

                        <div className="flex items-end justify-between max-w-sm mx-auto">
                            
                            <div className="mb-6 bg-white/80 dark:bg-night-800/80 backdrop-blur-sm rounded-2xl p-3 border border-slate-200 dark:border-slate-700 shadow-lg min-w-[80px] text-center relative">
                                <span className="block text-[10px] uppercase font-bold text-slate-400 tracking-wider">‡¶∏‡¶Æ‡¶Ø‡¶º</span>
                                <span className="block text-xl font-bold font-mono text-slate-800 dark:text-white">{formatTime(duration)}</span>
                                
                                {isTimerRunning && (
                                    <button 
                                        onClick={handleManualPause}
                                        className="absolute -top-2 -right-2 p-1 bg-red-100 dark:bg-red-900 text-red-600 rounded-full shadow-sm hover:scale-110 transition-transform"
                                    >
                                        <Pause size={10} fill="currentColor" />
                                    </button>
                                )}
                            </div>

                            <div className="relative">
                                <button 
                                    ref={buttonRef}
                                    onClick={handleTap}
                                    style={{ touchAction: 'manipulation', WebkitTapHighlightColor: 'transparent' }}
                                    className={`
                                        relative w-44 h-44 rounded-full flex items-center justify-center group overflow-hidden outline-none select-none touch-manipulation
                                        border-4
                                        ${isIdle 
                                            ? 'animate-[idleRedPulse_1.5s_infinite] border-red-500' 
                                            : darkMode 
                                                ? 'border-slate-700 shadow-[0_15px_35px_rgba(0,0,0,0.6)]' 
                                                : 'border-white shadow-[0_15px_35px_rgba(16,185,129,0.25)]'
                                        }
                                        ${darkMode
                                            ? 'bg-gradient-to-b from-slate-800 to-black'
                                            : 'bg-gradient-to-b from-white to-slate-100'
                                        }
                                    `}
                                >
                                    <div className="w-full h-full rounded-full flex items-center justify-center transition-transform duration-100 group-active:scale-95">
                                        <div className={`
                                            w-36 h-36 rounded-full flex items-center justify-center
                                            ${darkMode 
                                                ? 'bg-night-900 shadow-[inset_0_4px_15px_rgba(0,0,0,0.5)]' 
                                                : 'bg-slate-50 shadow-[inset_0_4px_15px_rgba(0,0,0,0.05)]'
                                            }
                                        `}>
                                            <div className={`
                                                w-28 h-28 rounded-full flex items-center justify-center
                                                ${darkMode
                                                    ? 'bg-gradient-to-br from-islamic-900 to-black border border-islamic-800'
                                                    : 'bg-gradient-to-br from-islamic-500 to-islamic-600 border border-islamic-400'
                                                }
                                                shadow-inner
                                            `}>
                                                <div className="text-white opacity-90 font-bold text-4xl tracking-tight drop-shadow-md font-mono">{sessionCount}</div>
                                            </div>
                                        </div>
                                    </div>
                                </button>
                            </div>

                            <div className="mb-6 bg-white/80 dark:bg-night-800/80 backdrop-blur-sm rounded-2xl p-3 border border-slate-200 dark:border-slate-700 shadow-lg min-w-[70px] text-center">
                                <span className="block text-[10px] uppercase font-bold text-slate-400 tracking-wider">‡¶Ü‡¶ú‡¶ï‡ßá</span>
                                <span className="block text-xl font-bold font-mono text-slate-800 dark:text-white">{displayCount}</span>
                            </div>
                        </div>
                </div>
                </div>
            );
        };

        // TargetList Component
        const TargetList = ({ targets, onToggle, onBack, onAdd, onEdit, onDelete }) => {
            const [showModal, setShowModal] = useState(false);
            const [showManager, setShowManager] = useState(false);

            const [editingId, setEditingId] = useState(null);
            const [name, setName] = useState('');
            const [description, setDescription] = useState('');
            const [neki, setNeki] = useState('');

            const openAddModal = () => {
                resetForm();
                setShowModal(true);
            };

            const openEditModal = (t) => {
                setEditingId(t.id);
                setName(t.name);
                setDescription(t.description);
                setNeki(t.neki.toString());
                setShowModal(true);
            };

            const handleSave = () => {
                if (!name.trim()) return;

                const targetData = {
                    id: editingId || Date.now().toString(),
                    name,
                    description,
                    neki: neki ? parseInt(neki) : 0,
                    completed: editingId ? targets.find(t => t.id === editingId)?.completed || false : false
                };

                if (editingId) {
                    onEdit(targetData);
                } else {
                    onAdd(targetData);
                }
                
                resetForm();
                setShowModal(false);
            };

            const resetForm = () => {
                setName('');
                setDescription('');
                setNeki('');
                setEditingId(null);
            };

            const confirmDelete = (id) => {
                toast((t) => (
                <div className="w-full">
                    <p className="font-bold text-lg text-slate-800 mb-4">‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶Ü‡¶Æ‡¶≤ ‡¶ï‡¶∞‡¶æ ‡¶¨‡¶æ‡¶¶ ‡¶¶‡¶ø‡¶§‡ßá ‡¶ö‡¶æ‡¶®?</p>
                    <div className="flex justify-end gap-3">
                        <button 
                            onClick={() => toast.dismiss(t.id)}
                            className="px-4 py-2 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200 transition-colors"
                        >
                            ‡¶®‡¶æ
                        </button>
                        <button 
                            onClick={() => {
                                onDelete(id);
                                toast.dismiss(t.id);
                                toast.success('‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá');
                            }}
                            className="px-4 py-2 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors"
                        >
                            ‡¶π‡ßç‡¶Ø‡¶æ‡¶Å
                        </button>
                    </div>
                </div>
                ), {
                    duration: 5000,
                    position: 'top-center',
                    style: {
                        background: '#fff',
                        color: '#1e293b',
                        border: '1px solid #e2e8f0',
                        padding: '24px',
                        borderRadius: '20px',
                        minWidth: '340px',
                        maxWidth: '90vw'
                    }
                });
            };

            const confirmToggle = (id) => {
                toast((t) => (
                <div className="w-full">
                    <p className="font-bold text-lg text-slate-800 mb-4">‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶è‡¶á ‡¶Ü‡¶Æ‡¶≤‡¶ü‡¶ø ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®?</p>
                    <div className="flex justify-end gap-3">
                        <button 
                            onClick={() => toast.dismiss(t.id)}
                            className="px-4 py-2 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200 transition-colors"
                        >
                            ‡¶®‡¶æ
                        </button>
                        <button 
                            onClick={() => {
                                onToggle(id);
                                toast.dismiss(t.id);
                            }}
                            className="px-4 py-2 bg-islamic-600 text-white rounded-xl font-bold hover:bg-islamic-700 transition-colors"
                        >
                            ‡¶π‡ßç‡¶Ø‡¶æ‡¶Å
                        </button>
                    </div>
                </div>
                ), {
                    duration: 5000,
                    position: 'top-center',
                    style: {
                        background: '#fff',
                        color: '#1e293b',
                        border: '1px solid #e2e8f0',
                        padding: '24px',
                        borderRadius: '20px',
                        minWidth: '340px',
                        maxWidth: '90vw'
                    }
                });
            };

            const handleTargetClick = (target) => {
                if (target.completed) return;
                confirmToggle(target.id);
            };

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-night-900 pb-24">
                <div className="bg-white dark:bg-night-800 p-4 sticky top-0 z-10 shadow-sm flex items-center justify-between">
                    <div className="flex items-center gap-3">
                        <button onClick={onBack} className="p-2 -ml-2 text-slate-600 dark:text-slate-300">
                        <ChevronLeft />
                        </button>
                        <h2 className="font-bold text-lg dark:text-white">‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶Ü‡¶Æ‡¶≤</h2>
                    </div>
                    <div className="flex gap-2">
                        <button onClick={() => setShowManager(true)} className="p-2 text-slate-500 hover:text-islamic-600 transition-colors">
                            <FolderCog size={20} />
                        </button>
                        <button onClick={openAddModal} className="p-2 text-islamic-600 font-medium text-sm flex items-center gap-1 bg-islamic-50 dark:bg-islamic-900/30 rounded-lg">
                            <Plus size={18} /> ‡¶Ø‡ßã‡¶ó
                        </button>
                    </div>
                </div>

                <div className="p-4 space-y-4">
                    {targets.map((target) => (
                    <div 
                        key={target.id} 
                        onClick={() => handleTargetClick(target)}
                        className={`p-4 rounded-2xl border transition-all duration-300 cursor-pointer ${
                            target.completed 
                            ? 'bg-islamic-50 dark:bg-islamic-900/10 border-islamic-200 dark:border-islamic-900' 
                            : 'bg-white dark:bg-night-800 border-slate-100 dark:border-slate-800 active:scale-[0.98]'
                        }`}
                    >
                        <div className="flex items-start gap-4">
                            <div className={`mt-1 transition-colors ${target.completed ? 'text-islamic-500' : 'text-slate-300 dark:text-slate-600'}`}>
                                {target.completed ? <CheckCircle2 size={24} className="fill-current" /> : <Circle size={24} />}
                            </div>
                            <div className="flex-1">
                                <h3 className={`font-bold text-lg ${target.completed ? 'text-islamic-700 dark:text-islamic-300 line-through decoration-2' : 'text-slate-800 dark:text-slate-100'}`}>
                                    {target.name}
                                </h3>
                                <p className="text-sm text-slate-500 dark:text-slate-400 mt-1">{target.description}</p>
                                <div className="mt-3 flex items-center gap-2">
                                    <span className="text-xs font-bold text-amber-500 bg-amber-50 dark:bg-amber-900/10 px-2 py-1 rounded-md border border-amber-100 dark:border-amber-900/20">
                                        +{target.neki} Neki
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                    ))}

                    <div className="mt-8 text-center p-6 bg-white dark:bg-night-800 rounded-2xl border border-slate-100 dark:border-slate-800">
                        <h3 className="text-islamic-600 font-bold mb-2">‡¶Ü‡¶™‡¶®‡¶ø ‡¶ï‡¶ø ‡¶ú‡¶æ‡¶®‡ßá‡¶®?</h3>
                        <p className="text-sm text-slate-600 dark:text-slate-300">
                            ‡¶Ø‡ßá ‡¶¨‡ßç‡¶Ø‡¶ï‡ßç‡¶§‡¶ø ‡¶∏‡¶ï‡¶æ‡¶≤‡ßá ‡¶ì ‡¶∏‡¶®‡ßç‡¶ß‡ßç‡¶Ø‡¶æ‡¶Ø‡¶º ‡ßß‡ß¶‡ß¶ ‡¶¨‡¶æ‡¶∞ '‡¶∏‡ßÅ‡¶¨‡¶π‡¶æ‡¶®‡¶æ‡¶≤‡ßç‡¶≤‡¶æ‡¶π‡¶ø ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶¨‡¶ø‡¶π‡¶æ‡¶Æ‡¶¶‡¶ø‡¶π‡¶ø' ‡¶™‡¶æ‡¶† ‡¶ï‡¶∞‡ßá, ‡¶ï‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ‡¶§‡ßá‡¶∞ ‡¶¶‡¶ø‡¶® ‡¶§‡¶æ‡¶∞ ‡¶ö‡ßá‡¶Ø‡¶º‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶Æ ‡¶Ü‡¶Æ‡¶≤ ‡¶®‡¶ø‡¶Ø‡¶º‡ßá ‡¶ï‡ßá‡¶â ‡¶Ü‡¶∏‡¶¨‡ßá ‡¶®‡¶æ‡•§
                        </p>
                    </div>
                </div>

                {showManager && (
                    <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm">
                        <div className="bg-white dark:bg-night-800 rounded-2xl w-full max-w-sm shadow-xl flex flex-col max-h-[80vh] border dark:border-slate-700">
                            <div className="p-4 border-b border-slate-100 dark:border-slate-700 flex justify-between items-center">
                                <h3 className="font-bold text-lg dark:text-white flex items-center gap-2"><FolderCog size={20}/> ‡¶´‡¶æ‡¶á‡¶≤ ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßá‡¶ú‡¶æ‡¶∞</h3>
                                <button onClick={() => setShowManager(false)} className="p-1 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 text-slate-500"><X size={20}/></button>
                            </div>
                            <div className="overflow-y-auto p-2 space-y-2">
                                {targets.map(t => (
                                    <div key={t.id} className="flex items-center justify-between p-3 bg-slate-50 dark:bg-black rounded-xl border border-slate-200 dark:border-slate-700">
                                        <span className="font-medium text-slate-700 dark:text-slate-200 truncate pr-2">{t.name}</span>
                                        <div className="flex gap-2">
                                            <button 
                                                onClick={() => { setShowManager(false); openEditModal(t); }} 
                                                className="p-2 bg-blue-50 dark:bg-blue-900/20 text-blue-600 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/40"
                                            >
                                                <Pencil size={16} />
                                            </button>
                                            <button 
                                                onClick={() => confirmDelete(t.id)} 
                                                className="p-2 bg-red-50 dark:bg-red-900/20 text-red-600 rounded-lg hover:bg-red-100 dark:hover:bg-red-900/40"
                                            >
                                                <Trash2 size={16} />
                                            </button>
                                        </div>
                                    </div>
                                ))}
                                {targets.length === 0 && <p className="text-center text-slate-400 py-4">‡¶§‡¶æ‡¶≤‡¶ø‡¶ï‡¶æ ‡¶ñ‡¶æ‡¶≤‡¶ø</p>}
                            </div>
                        </div>
                    </div>
                )}

                {showModal && (
                    <div className="fixed inset-0 bg-black/80 z-50 flex items-center justify-center p-4 backdrop-blur-sm overflow-y-auto">
                    <div className="bg-white dark:bg-night-800 rounded-2xl p-6 w-full max-w-sm shadow-xl max-h-[90vh] overflow-y-auto no-scrollbar border dark:border-slate-700">
                        <h3 className="text-lg font-bold mb-4 dark:text-white">{editingId ? '‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶è‡¶°‡¶ø‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®' : '‡¶®‡¶§‡ßÅ‡¶® ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡ßÅ‡¶®'}</h3>
                        
                        <div className="space-y-4">
                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-1">‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ (‡¶Ü‡¶¨‡¶∂‡ßç‡¶Ø‡¶ï)</label>
                                <input 
                                type="text" 
                                placeholder="‡¶Ø‡ßá‡¶Æ‡¶®: ‡¶∏‡ßÇ‡¶∞‡¶æ ‡¶á‡¶Ø‡¶º‡¶æ‡¶∏‡¶ø‡¶® ‡¶™‡¶æ‡¶†" 
                                className="w-full p-3 rounded-xl border border-slate-200 bg-white dark:border-slate-700 dark:bg-black dark:text-white"
                                value={name}
                                onChange={e => setName(e.target.value)}
                                />
                            </div>

                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-1">‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ/‡¶´‡¶ú‡¶ø‡¶≤‡¶§ (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)</label>
                                <textarea 
                                placeholder="‡¶¨‡¶∞‡ßç‡¶£‡¶®‡¶æ ‡¶¶‡¶ø‡¶®..." 
                                className="w-full p-3 rounded-xl border border-slate-200 bg-white dark:border-slate-700 dark:bg-black dark:text-white h-20 resize-none"
                                value={description}
                                onChange={e => setDescription(e.target.value)}
                                />
                            </div>

                            <div>
                                <label className="block text-xs font-bold text-slate-500 mb-1">‡¶®‡ßá‡¶ï‡¶ø ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£ (‡¶Ö‡¶™‡¶∂‡¶®‡¶æ‡¶≤)</label>
                                <input 
                                type="number" 
                                placeholder="‡¶â‡¶¶‡¶æ‡¶É 100" 
                                className="w-full p-3 rounded-xl border border-slate-200 bg-white dark:border-slate-700 dark:bg-black dark:text-white"
                                value={neki}
                                onChange={e => setNeki(e.target.value)}
                                />
                            </div>
                        </div>

                        <div className="flex gap-3 mt-6">
                        <button onClick={() => setShowModal(false)} className="flex-1 py-3 rounded-xl bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 font-semibold">‡¶¨‡¶æ‡¶§‡¶ø‡¶≤</button>
                        <button onClick={handleSave} className="flex-1 py-3 rounded-xl bg-islamic-600 text-white font-semibold shadow-lg shadow-islamic-600/30">‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£</button>
                        </div>
                    </div>
                    </div>
                )}
                </div>
            );
        };

        // Journal Component
        const Journal = ({ entries, onAdd }) => {
            const [text, setText] = useState('');
            const [showHistory, setShowHistory] = useState(false);

            const handleSave = () => {
                if (!text.trim()) return;
                onAdd(text);
                setText('');
                setShowHistory(true); 
            };

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-night-900 pb-24">
                <div className="bg-white dark:bg-night-800 p-4 sticky top-0 z-10 shadow-sm flex items-center justify-between">
                    <h2 className="font-bold text-lg dark:text-white flex items-center gap-2">
                        <PenLine size={20} className="text-islamic-600"/> ‡¶ú‡¶æ‡¶∞‡ßç‡¶®‡¶æ‡¶≤
                    </h2>
                    {showHistory && (
                        <button 
                            onClick={() => setShowHistory(false)}
                            className="text-xs font-bold bg-indigo-50 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-400 px-3 py-1.5 rounded-full flex items-center gap-1 transition-colors active:scale-95"
                        >
                            <PenLine size={14}/> ‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®
                        </button>
                    )}
                </div>

                <div className="p-4">
                    {showHistory ? (
                        <div className="max-w-lg mx-auto animate-fade-in">
                            <div className="flex items-center justify-center mb-6">
                                <span className="bg-indigo-100 dark:bg-indigo-900/30 text-indigo-600 dark:text-indigo-300 px-4 py-1 rounded-full text-xs font-bold uppercase tracking-wider">
                                    ‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú ‡¶∏‡¶Æ‡ßÇ‡¶π ({entries.length})
                                </span>
                            </div>

                            {entries.length === 0 ? (
                                <div className="flex flex-col items-center justify-center min-h-[50vh] text-slate-400 bg-white dark:bg-night-800 rounded-3xl border border-slate-100 dark:border-slate-800 shadow-sm p-8 mx-4">
                                    <div className="w-16 h-16 bg-slate-50 dark:bg-slate-900 rounded-full flex items-center justify-center mb-4">
                                        <FolderOpen size={32} className="opacity-40 text-slate-500"/>
                                    </div>
                                    <p className="font-bold text-lg text-slate-600 dark:text-slate-300">‡¶ï‡ßã‡¶®‡ßã ‡¶ú‡¶æ‡¶∞‡ßç‡¶®‡¶æ‡¶≤ ‡¶®‡ßá‡¶á</p>
                                    <p className="text-xs mt-2 opacity-60 text-center">‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Æ‡¶®‡ßá‡¶∞ ‡¶ï‡¶•‡¶æ‡¶ó‡ßÅ‡¶≤‡ßã ‡¶≤‡¶ø‡¶ñ‡ßá ‡¶∞‡¶æ‡¶ñ‡¶§‡ßá '‡¶®‡¶§‡ßÅ‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®' ‡¶¨‡¶æ‡¶ü‡¶®‡ßá ‡¶ö‡¶æ‡¶™ ‡¶¶‡¶ø‡¶®</p>
                                </div>
                            ) : (
                                <div className="space-y-4 pb-10">
                                    {entries.map(entry => (
                                        <div key={entry.id} className="bg-white dark:bg-night-800 p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-800 hover:shadow-md transition-all duration-300">
                                            <div className="flex items-center justify-between mb-3 border-b border-slate-50 dark:border-slate-700/50 pb-2">
                                                <div className="flex items-center gap-2 text-slate-600 dark:text-slate-300 text-xs font-bold">
                                                    <div className="bg-islamic-50 dark:bg-islamic-900/30 p-1.5 rounded-md text-islamic-600">
                                                        <Calendar size={14}/>
                                                    </div>
                                                    <span>{entry.date}</span>
                                                </div>
                                                <span className="text-[10px] text-slate-400 font-mono bg-slate-50 dark:bg-slate-900 px-2 py-1 rounded-lg">
                                                    {new Date(entry.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                                                </span>
                                            </div>
                                            <div className="relative pl-2">
                                                <Quote size={12} className="absolute -top-1 -left-1 text-slate-200 dark:text-slate-700 transform -scale-x-100" />
                                                <p className="text-slate-700 dark:text-slate-200 whitespace-pre-wrap leading-relaxed text-sm font-medium">
                                                    {entry.text}
                                                </p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>
                    ) : (
                        <div className="max-w-lg mx-auto space-y-5 animate-fade-in">
                            <div className="bg-white dark:bg-night-800 rounded-2xl p-5 shadow-sm border border-slate-100 dark:border-slate-800">
                                <label className="block text-sm font-bold text-slate-700 dark:text-slate-200 mb-3 flex items-center gap-2">
                                    <span className="w-1 h-4 bg-islamic-500 rounded-full"></span>
                                    ‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶≠‡ßÇ‡¶§‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®
                                </label>
                                <textarea 
                                    value={text}
                                    onChange={(e) => setText(e.target.value)}
                                    placeholder="‡¶Ü‡¶ú ‡¶Ü‡¶Æ‡¶ø..."
                                    className="w-full h-40 p-4 rounded-xl bg-slate-50 dark:bg-black border border-slate-200 dark:border-slate-700 text-slate-800 dark:text-white resize-none focus:ring-2 focus:ring-islamic-500 outline-none transition-all placeholder:text-slate-400 leading-relaxed"
                                ></textarea>
                                
                                <div className="flex justify-between items-center mt-4">
                                    <span className="text-xs text-slate-400 font-mono">{text.length} characters</span>
                                    <button 
                                        onClick={handleSave}
                                        disabled={!text.trim()}
                                        className="bg-islamic-600 text-white px-6 py-2.5 rounded-xl font-bold shadow-lg shadow-islamic-600/30 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-islamic-700 active:scale-95 transition-all"
                                    >
                                        <Save size={18} /> ‡¶∏‡¶Ç‡¶∞‡¶ï‡ßç‡¶∑‡¶£
                                    </button>
                                </div>
                            </div>

                            <div 
                                onClick={() => setShowHistory(true)}
                                className="bg-white dark:bg-night-800 p-4 rounded-2xl border border-slate-200 dark:border-slate-700 shadow-sm flex items-center gap-4 cursor-pointer hover:shadow-md transition-all group active:scale-[0.98]"
                            >
                                <div className="w-12 h-12 bg-indigo-50 dark:bg-indigo-900/20 rounded-xl flex items-center justify-center text-indigo-500 group-hover:scale-110 transition-transform">
                                    <FileText size={24} className="drop-shadow-sm" />
                                </div>
                                <div className="flex-1">
                                    <h3 className="font-bold text-slate-700 dark:text-slate-200 text-base group-hover:text-indigo-600 dark:group-hover:text-indigo-400 transition-colors">‡¶™‡ßÇ‡¶∞‡ßç‡¶¨‡ßá‡¶∞ ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú ‡¶∏‡¶Æ‡ßÇ‡¶π</h3>
                                    <p className="text-xs text-slate-500 dark:text-slate-400 mt-0.5">{entries.length} ‡¶ü‡¶ø ‡¶è‡¶®‡ßç‡¶ü‡ßç‡¶∞‡¶ø ‡¶ú‡¶Æ‡¶æ ‡¶Ü‡¶õ‡ßá</p>
                                </div>
                                <div className="text-slate-300 dark:text-slate-600 group-hover:text-indigo-500 dark:group-hover:text-indigo-400 transition-colors">
                                    <ChevronRight size={20} />
                                </div>
                            </div>

                            <div className="bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-900/20 dark:to-indigo-900/20 p-5 rounded-2xl border border-blue-100 dark:border-blue-800/50">
                                <h4 className="text-blue-700 dark:text-blue-300 font-bold text-sm mb-2 flex items-center gap-2">
                                    <div className="bg-white dark:bg-blue-800/50 p-1 rounded-full"><PenLine size={12}/></div>
                                    ‡¶ï‡ßá‡¶® ‡¶≤‡¶ø‡¶ñ‡¶¨‡ßá‡¶®?
                                </h4>
                                <p className="text-blue-600 dark:text-blue-200 text-xs leading-relaxed opacity-90">
                                    ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶ø‡¶® ‡¶Ö‡¶®‡ßç‡¶§‡¶§ ‡¶è‡¶ï‡¶ü‡¶ø ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú ‡¶¨‡¶æ ‡¶Ö‡¶®‡ßÅ‡¶≠‡ßÇ‡¶§‡¶ø ‡¶≤‡¶ø‡¶ñ‡ßá ‡¶∞‡¶æ‡¶ñ‡¶≤‡ßá ‡¶§‡¶æ ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶Æ‡¶æ‡¶®‡¶∏‡¶ø‡¶ï‡¶≠‡¶æ‡¶¨‡ßá ‡¶™‡ßç‡¶∞‡¶∂‡¶æ‡¶®‡ßç‡¶§‡¶ø ‡¶¶‡ßá‡¶¨‡ßá ‡¶è‡¶¨‡¶Ç ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡¶Ü‡¶∞‡¶ì ‡¶â‡ßé‡¶∏‡¶æ‡¶π‡¶ø‡¶§ ‡¶ï‡¶∞‡¶¨‡ßá‡•§
                                </p>
                            </div>
                        </div>
                    )}
                </div>
                </div>
            );
        };

        // Analysis Component
        const Analysis = ({ stats, tasbihs, targets, history }) => {
            const liveTodayTime = tasbihs.reduce((acc, t) => acc + (t.todayTime || 0), 0);
            const now = new Date();
            const todayStr = now.toISOString().split('T')[0];
            
            const getHistoryTime = (daysBack) => {
                const cutoff = new Date();
                cutoff.setDate(cutoff.getDate() - daysBack);
                
                const filtered = history.filter(h => {
                    const hDate = new Date(h.date);
                    return h.date !== todayStr && hDate >= cutoff;
                });
                
                const pastTime = filtered.reduce((acc, h) => acc + h.totalTime, 0);
                return pastTime + liveTodayTime;
            };

            const timeLast7Days = getHistoryTime(6);
            const timeLast30Days = getHistoryTime(29);
            const allTimeTotal = history.reduce((acc, h) => acc + h.totalTime, 0) + (history.find(h=>h.date===todayStr) ? 0 : liveTodayTime);

            const formatDuration = (seconds) => {
                if (seconds < 60) return `${seconds} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`;
                const h = Math.floor(seconds / 3600);
                const m = Math.floor((seconds % 3600) / 60);
                if (h > 0) return `${h} ‡¶ò‡¶£‡ßç‡¶ü‡¶æ ${m} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü`;
                return `${m} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ${seconds % 60} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`;
            };

            const formatDurationShort = (seconds) => {
                if (seconds < 60) return `${seconds} ‡¶∏‡ßá‡¶É`;
                const h = Math.floor(seconds / 3600);
                const m = Math.floor((seconds % 3600) / 60);
                if (h > 0) return `${h}‡¶ò‡¶É ${m}‡¶Æ‡¶ø‡¶É`;
                return `${m} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü`;
            };

            const chartData = [];
            for (let i = 6; i >= 0; i--) {
                const d = new Date();
                d.setDate(d.getDate() - i);
                const dStr = d.toISOString().split('T')[0];
                let dayName = d.toLocaleDateString('bn-BD', { weekday: 'short' });
                if (i === 0) dayName = '‡¶Ü‡¶ú'; 

                let time = 0;
                if (i === 0) {
                    time = liveTodayTime;
                } else {
                    const entry = history.find(h => h.date === dStr);
                    time = entry ? entry.totalTime : 0;
                }
                const minutes = parseFloat((time / 60).toFixed(1)); 
                const fullDateString = d.toLocaleDateString('bn-BD', { day: 'numeric', month: 'long', year: 'numeric' });

                chartData.push({
                    name: dayName,
                    minutes: minutes,
                    seconds: time,
                    fullDate: dStr,
                    fullDateString: fullDateString,
                    isToday: i === 0
                });
            }

            const completedTargets = targets.filter(t => t.completed).length;
            const productivity = Math.round((completedTargets / targets.length) * 100);

            const handleBarClick = (data) => {
                if (!data || !data.payload) return;
                const entry = data.payload;
                const timeString = formatDuration(entry.seconds);

                toast.custom((t) => (
                    <div className={`${t.visible ? 'animate-enter' : 'animate-leave'} max-w-sm w-full bg-white dark:bg-night-800 shadow-lg rounded-2xl pointer-events-auto flex ring-1 ring-black ring-opacity-5 dark:ring-white dark:ring-opacity-10 border border-islamic-100 dark:border-islamic-900`}>
                    <div className="flex-1 w-0 p-4">
                        <div className="flex items-start">
                        <div className="flex-shrink-0 pt-0.5">
                            <div className="h-10 w-10 rounded-full bg-islamic-100 dark:bg-islamic-900/30 flex items-center justify-center text-islamic-600 dark:text-islamic-400">
                                <Clock size={20} />
                            </div>
                        </div>
                        <div className="ml-3 flex-1">
                            <p className="text-sm font-bold text-slate-900 dark:text-slate-100">
                            {entry.name} ({entry.fullDateString})
                            </p>
                            <p className="mt-1 text-sm text-slate-500 dark:text-slate-400">
                            ‡¶Æ‡ßã‡¶ü ‡¶∏‡¶Æ‡ßü: <span className="text-islamic-600 dark:text-islamic-400 font-bold">{timeString}</span>
                            </p>
                        </div>
                        </div>
                    </div>
                    </div>
                ), { position: 'top-center', duration: 3000 });
            };

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-night-900 pb-24 p-4">
                <h2 className="text-2xl font-bold text-slate-800 dark:text-white mb-6">‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</h2>

                <div className="grid grid-cols-2 gap-4 mb-6">
                    <div className="bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700">
                        <div className="text-slate-500 dark:text-slate-400 text-xs font-bold uppercase">‡¶™‡ßç‡¶∞‡ßã‡¶°‡¶æ‡¶ï‡ßç‡¶ü‡¶ø‡¶≠‡¶ø‡¶ü‡¶ø</div>
                        <div className="text-2xl font-bold text-islamic-600 mt-1">{productivity}%</div>
                        <div className="text-xs text-slate-400 mt-2">‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶Ü‡¶Æ‡¶≤ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£</div>
                    </div>
                    <div className="bg-white dark:bg-slate-800 p-4 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700">
                        <div className="text-slate-500 dark:text-slate-400 text-xs font-bold uppercase">‡¶ß‡¶æ‡¶∞‡¶æ‡¶¨‡¶æ‡¶π‡¶ø‡¶ï‡¶§‡¶æ</div>
                        <div className="text-2xl font-bold text-orange-500 mt-1">{stats.streak} ‡¶¶‡¶ø‡¶®</div>
                        <div className="text-xs text-slate-400 mt-2">‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßÄ‡¶ï ‡¶¨‡¶ú‡¶æ‡¶Ø‡¶º ‡¶∞‡¶æ‡¶ñ‡ßÅ‡¶®</div>
                    </div>
                </div>

                <h3 className="font-bold text-slate-700 dark:text-slate-200 mb-4 flex items-center gap-2">
                    <Clock size={20} className="text-indigo-500"/> ‡¶∏‡¶Æ‡¶Ø‡¶º‡ßá‡¶∞ ‡¶π‡¶ø‡¶∏‡¶æ‡¶¨
                </h3>
                
                <div className="grid grid-cols-2 gap-3 mb-6">
                    <div className="bg-gradient-to-br from-indigo-50 to-white dark:from-indigo-900/20 dark:to-slate-800 p-4 rounded-2xl border border-indigo-100 dark:border-indigo-900/30 shadow-sm">
                        <div className="flex items-center gap-2 mb-1">
                            <Clock size={14} className="text-indigo-500"/>
                            <span className="text-[10px] uppercase font-bold text-slate-500 dark:text-slate-400">‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º</span>
                        </div>
                        <div className="text-xl font-bold text-slate-800 dark:text-white">{formatDurationShort(liveTodayTime)}</div>
                    </div>

                    <div className="bg-gradient-to-br from-emerald-50 to-white dark:from-emerald-900/20 dark:to-slate-800 p-4 rounded-2xl border border-emerald-100 dark:border-emerald-900/30 shadow-sm">
                        <div className="flex items-center gap-2 mb-1">
                            <History size={14} className="text-emerald-500"/>
                            <span className="text-[10px] uppercase font-bold text-slate-500 dark:text-slate-400">‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü</span>
                        </div>
                        <div className="text-xl font-bold text-slate-800 dark:text-white">{formatDurationShort(allTimeTotal)}</div>
                    </div>

                    <div className="bg-white dark:bg-slate-800 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm">
                        <div className="flex items-center gap-2 mb-1">
                            <Calendar size={14} className="text-blue-500"/>
                            <span className="text-[10px] uppercase font-bold text-slate-500 dark:text-slate-400">‡¶ó‡¶§ ‡ß≠ ‡¶¶‡¶ø‡¶®</span>
                        </div>
                        <div className="text-lg font-bold text-slate-700 dark:text-slate-200">{formatDurationShort(timeLast7Days)}</div>
                    </div>

                    <div className="bg-white dark:bg-slate-800 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 shadow-sm">
                        <div className="flex items-center gap-2 mb-1">
                            <TrendingUp size={14} className="text-purple-500"/>
                            <span className="text-[10px] uppercase font-bold text-slate-500 dark:text-slate-400">‡¶ó‡¶§ ‡ß©‡ß¶ ‡¶¶‡¶ø‡¶®</span>
                        </div>
                        <div className="text-lg font-bold text-slate-700 dark:text-slate-200">{formatDurationShort(timeLast30Days)}</div>
                    </div>
                </div>

                <div className="bg-white dark:bg-night-800 p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 mb-6">
                    <h3 className="font-bold text-slate-700 dark:text-slate-200 mb-1">‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶™‡¶æ‡¶†‡ßá‡¶∞ ‡¶∏‡¶Æ‡¶Ø‡¶º (‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü)</h3>
                    <p className="text-xs text-slate-400 mb-4">‡¶ó‡¶§ ‡ß≠ ‡¶¶‡¶ø‡¶®‡ßá‡¶∞ ‡¶§‡ßÅ‡¶≤‡¶®‡¶æ (‡¶ï‡ßç‡¶≤‡¶ø‡¶ï ‡¶ï‡¶∞‡ßá ‡¶¨‡¶ø‡¶∏‡ßç‡¶§‡¶æ‡¶∞‡¶ø‡¶§ ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®)</p>
                    
                    <div className="h-48 w-full">
                        <ResponsiveContainer width="100%" height="100%">
                            <BarChart data={chartData}>
                                <XAxis 
                                    dataKey="name" 
                                    stroke="#94a3b8" 
                                    fontSize={11} 
                                    tickLine={false} 
                                    axisLine={false}
                                    interval={0}
                                    tick={({ x, y, payload }) => (
                                        <text 
                                            x={x} 
                                            y={y + 12} 
                                            textAnchor="middle" 
                                            fill={payload.value === '‡¶Ü‡¶ú' ? '#16a34a' : '#94a3b8'} 
                                            fontSize={11} 
                                            fontWeight={payload.value === '‡¶Ü‡¶ú' ? 'bold' : 'normal'}
                                        >
                                            {payload.value}
                                        </text>
                                    )} 
                                />
                                <Bar 
                                    dataKey="minutes" 
                                    radius={[4, 4, 0, 0]} 
                                    onClick={handleBarClick} 
                                    cursor="pointer"
                                >
                                    {chartData.map((entry, index) => (
                                        <Cell 
                                            key={`cell-${index}`} 
                                            fill={entry.isToday ? '#16a34a' : '#cbd5e1'} 
                                            className={`transition-opacity hover:opacity-80 ${!entry.isToday ? "dark:fill-slate-600" : ""}`}
                                        />
                                    ))}
                                </Bar>
                            </BarChart>
                        </ResponsiveContainer>
                    </div>
                </div>

                <div className="bg-white dark:bg-night-800 p-5 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700">
                    <h3 className="font-bold text-slate-700 dark:text-slate-200 mb-4">‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶∏‡¶æ‡¶∞‡¶æ‡¶Ç‡¶∂ (‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü)</h3>
                    <div className="space-y-4">
                        {tasbihs.map(t => (
                            <div key={t.id} className="flex flex-col gap-1">
                                <div className="flex justify-between items-end">
                                    <span className="text-sm font-medium text-slate-700 dark:text-slate-300">{t.name}</span>
                                    <span className="text-xs font-bold text-slate-500 dark:text-slate-400">{t.totalCount} ‡¶¨‡¶æ‡¶∞</span>
                                </div>
                                <div className="w-full h-1.5 bg-slate-100 dark:bg-slate-700 rounded-full overflow-hidden">
                                    <div className="h-full bg-islamic-500" style={{ width: `${Math.min((t.totalCount / 5000) * 100, 100)}%` }}></div>
                                </div>
                            </div>
                        ))}
                        {tasbihs.length === 0 && <p className="text-center text-slate-400 text-xs">‡¶ï‡ßã‡¶®‡ßã ‡¶°‡¶æ‡¶ü‡¶æ ‡¶®‡ßá‡¶á</p>}
                    </div>
                </div>
                </div>
            );
        };

        // Inbox Component
        const Inbox = ({ messages, onMarkRead, onDelete, onDeleteMultiple, onBack, onClaim }) => {
            const [selectedMessage, setSelectedMessage] = useState(null);
            const [selectedIds, setSelectedIds] = useState([]);
            const [isSelectionMode, setIsSelectionMode] = useState(false);
            const pressTimer = useRef(null);

            const handleTouchStart = (id) => {
                if (isSelectionMode) return;
                pressTimer.current = setTimeout(() => {
                    setIsSelectionMode(true);
                    toggleSelection(id);
                    if (navigator.vibrate) navigator.vibrate(50);
                }, 500); 
            };

            const handleTouchEnd = () => {
                if (pressTimer.current) {
                    clearTimeout(pressTimer.current);
                    pressTimer.current = null;
                }
            };

            const toggleSelection = (id) => {
                if (selectedIds.includes(id)) {
                    const newSelection = selectedIds.filter(sid => sid !== id);
                    setSelectedIds(newSelection);
                    if (newSelection.length === 0) setIsSelectionMode(false);
                } else {
                    setSelectedIds([...selectedIds, id]);
                }
            };

            const cancelSelectionMode = () => {
                setIsSelectionMode(false);
                setSelectedIds([]);
            };

            const handleMessageClick = (msg) => {
                if (isSelectionMode) {
                    toggleSelection(msg.id);
                } else {
                    handleOpenMessage(msg);
                }
            };

            const handleOpenMessage = (msg) => {
                setSelectedMessage(msg);
                if (!msg.read) {
                    onMarkRead(msg.id);
                }
            };

            const handleCloseMessage = () => {
                setSelectedMessage(null);
            };

            const confirmDelete = (id) => {
                toast((t) => (
                <div className="w-full">
                    <p className="font-bold text-lg text-slate-800 mb-4">‡¶Æ‡ßá‡¶∏‡ßá‡¶ú‡¶ü‡¶ø ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?</p>
                    <div className="flex justify-end gap-3">
                        <button 
                            onClick={() => toast.dismiss(t.id)}
                            className="px-4 py-2 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200 transition-colors"
                        >
                            ‡¶®‡¶æ
                        </button>
                        <button 
                            onClick={() => {
                                onDelete(id);
                                toast.dismiss(t.id);
                                handleCloseMessage();
                                toast.success('‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá');
                            }}
                            className="px-4 py-2 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors"
                        >
                            ‡¶π‡ßç‡¶Ø‡¶æ‡¶Å
                        </button>
                    </div>
                </div>
                ), {
                    duration: 5000,
                    position: 'top-center',
                    style: {
                        background: '#fff',
                        color: '#1e293b',
                        border: '1px solid #e2e8f0',
                        padding: '24px',
                        borderRadius: '20px',
                        minWidth: '340px',
                        maxWidth: '90vw'
                    }
                });
            };

            const confirmBulkDelete = () => {
                if (selectedIds.length === 0) return;
                toast((t) => (
                <div className="w-full">
                    <p className="font-bold text-lg text-slate-800 mb-4">{selectedIds.length} ‡¶ü‡¶ø ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶°‡¶ø‡¶≤‡¶ø‡¶ü ‡¶ï‡¶∞‡¶§‡ßá ‡¶ö‡¶æ‡¶®?</p>
                    <div className="flex justify-end gap-3">
                        <button 
                            onClick={() => toast.dismiss(t.id)}
                            className="px-4 py-2 bg-slate-100 text-slate-700 rounded-xl font-bold hover:bg-slate-200 transition-colors"
                        >
                            ‡¶®‡¶æ
                        </button>
                        <button 
                            onClick={() => {
                                onDeleteMultiple(selectedIds);
                                toast.dismiss(t.id);
                                cancelSelectionMode();
                            }}
                            className="px-4 py-2 bg-red-500 text-white rounded-xl font-bold hover:bg-red-600 transition-colors"
                        >
                            ‡¶π‡ßç‡¶Ø‡¶æ‡¶Å
                        </button>
                    </div>
                </div>
                ), {
                    duration: 5000,
                    position: 'top-center',
                    style: {
                        background: '#fff',
                        color: '#1e293b',
                        border: '1px solid #e2e8f0',
                        padding: '24px',
                        borderRadius: '20px',
                        minWidth: '340px',
                        maxWidth: '90vw'
                    }
                });
            };

            if (selectedMessage) {
                return (
                    <div className="min-h-screen bg-slate-50 dark:bg-night-900 pb-24 flex flex-col">
                        <div className="bg-white dark:bg-night-800 p-4 sticky top-0 z-10 shadow-sm flex items-center justify-between border-b border-slate-100 dark:border-slate-700">
                            <div className="flex items-center gap-2">
                                <button onClick={handleCloseMessage} className="p-2 -ml-2 text-slate-600 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 rounded-full transition-colors">
                                    <ChevronLeft />
                                </button>
                                <h2 className="font-bold text-lg dark:text-white truncate max-w-[200px]">{selectedMessage.title}</h2>
                            </div>
                            <button 
                                onClick={() => confirmDelete(selectedMessage.id)} 
                                className="p-2 text-red-500 hover:bg-red-50 dark:hover:bg-red-900/20 rounded-full transition-colors"
                            >
                                <Trash2 size={20} />
                            </button>
                        </div>
                        
                        <div className="p-4 overflow-y-auto">
                            <div className="bg-white dark:bg-night-800 rounded-2xl p-6 shadow-sm border border-slate-100 dark:border-slate-700">
                                <div className="flex justify-between items-start mb-6">
                                    <div className="flex items-center gap-3">
                                        <div className={`p-3 rounded-full ${selectedMessage.type === 'report' ? 'bg-blue-100 text-blue-600' : 'bg-islamic-100 text-islamic-600'}`}>
                                            <MailOpen size={24} />
                                        </div>
                                        <div>
                                            <h3 className="font-bold text-slate-800 dark:text-white text-lg">{selectedMessage.title}</h3>
                                            <p className="text-xs text-slate-500 dark:text-slate-400">
                                                {new Date(selectedMessage.date).toLocaleDateString()} &bull; {new Date(selectedMessage.date).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="prose dark:prose-invert max-w-none text-slate-700 dark:text-slate-300 leading-relaxed whitespace-pre-wrap">
                                    {selectedMessage.body}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            }

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-night-900 pb-24">
                <div className={`
                    p-4 sticky top-0 z-10 shadow-sm flex items-center justify-between border-b transition-colors
                    ${isSelectionMode 
                        ? 'bg-indigo-600 border-indigo-500 text-white' 
                        : 'bg-white dark:bg-night-800 border-slate-100 dark:border-slate-700'
                    }
                `}>
                    {isSelectionMode ? (
                        <>
                            <div className="flex items-center gap-3">
                                <button onClick={cancelSelectionMode} className="p-1 hover:bg-indigo-500 rounded-full">
                                    <X size={24} />
                                </button>
                                <span className="font-bold text-lg">{selectedIds.length} ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶ø‡¶§</span>
                            </div>
                            <button 
                                onClick={confirmBulkDelete}
                                className="p-2 bg-white/20 hover:bg-white/30 rounded-lg transition-colors"
                            >
                                <Trash2 size={20} className="text-white"/>
                            </button>
                        </>
                    ) : (
                        <>
                            <div className="flex items-center gap-3">
                                <button onClick={onBack} className="p-2 -ml-2 text-slate-600 dark:text-slate-300">
                                <ChevronLeft />
                                </button>
                                <h2 className="font-bold text-lg dark:text-white">‡¶á‡¶®‡¶¨‡¶ï‡ßç‡¶∏</h2>
                            </div>
                        </>
                    )}
                </div>

                <div className="p-4 space-y-3">
                    {messages.length === 0 ? (
                        <div className="flex flex-col items-center justify-center py-20 text-slate-400">
                            <MailOpen size={48} className="mb-4 opacity-50" />
                            <p>‡¶ï‡ßã‡¶® ‡¶®‡¶§‡ßÅ‡¶® ‡¶¨‡¶æ‡¶∞‡ßç‡¶§‡¶æ ‡¶®‡ßá‡¶á</p>
                        </div>
                    ) : (
                        messages.map((msg) => {
                            const isSelected = selectedIds.includes(msg.id);
                            
                            return (
                            <div 
                                key={msg.id} 
                                onClick={() => handleMessageClick(msg)}
                                onTouchStart={() => handleTouchStart(msg.id)}
                                onTouchEnd={handleTouchEnd}
                                onMouseDown={() => handleTouchStart(msg.id)}
                                onMouseUp={handleTouchEnd}
                                onMouseLeave={handleTouchEnd}
                                onContextMenu={(e) => { e.preventDefault(); }} 
                                className={`
                                    p-4 rounded-xl border shadow-sm flex items-center gap-4 cursor-pointer transition-all active:scale-[0.99] select-none
                                    ${isSelectionMode && isSelected 
                                        ? 'bg-indigo-50 dark:bg-indigo-900/30 border-indigo-200 dark:border-indigo-700 ring-1 ring-indigo-300'
                                        : !msg.read 
                                            ? 'bg-emerald-50 dark:bg-emerald-900/10 border-emerald-200 dark:border-emerald-800/50' 
                                            : 'bg-white dark:bg-night-800 border-slate-100 dark:border-slate-700 opacity-90'
                                    }
                                `}
                            >
                                {isSelectionMode ? (
                                    <div className={`p-1 rounded-md transition-colors ${isSelected ? 'text-indigo-600' : 'text-slate-300'}`}>
                                        {isSelected ? <CheckSquare size={24} fill="currentColor" className="text-white" /> : <div className="w-6 h-6 border-2 border-slate-300 rounded-md"></div>}
                                    </div>
                                ) : (
                                    <div className={`
                                        p-3 rounded-full shrink-0 flex items-center justify-center transition-colors
                                        ${!msg.read 
                                            ? 'bg-emerald-100 text-emerald-600 dark:bg-emerald-900/40 dark:text-emerald-400' 
                                            : 'bg-slate-100 text-slate-400 dark:bg-slate-800 dark:text-slate-500'
                                        }
                                    `}>
                                        {msg.read ? <MailOpen size={20} /> : <Mail size={20} />}
                                    </div>
                                )}
                                
                                <div className="flex-1 min-w-0">
                                    <div className="flex justify-between items-center mb-1">
                                        <h3 className={`font-bold text-sm truncate ${!msg.read ? 'text-slate-800 dark:text-white' : 'text-slate-600 dark:text-slate-400'}`}>
                                            {msg.title}
                                        </h3>
                                        <span className={`text-[10px] whitespace-nowrap ${!msg.read ? 'text-emerald-600 dark:text-emerald-400 font-medium' : 'text-slate-400'}`}>
                                            {new Date(msg.date).toLocaleDateString()}
                                        </span>
                                    </div>
                                    <p className={`text-xs truncate ${!msg.read ? 'text-slate-600 dark:text-slate-300 font-medium' : 'text-slate-400 dark:text-slate-500'}`}>
                                        {msg.body}
                                    </p>
                                </div>
                            </div>
                        )})
                    )}
                </div>
                </div>
            );
        };

        // Garden Component
        const Garden = ({ trees, tasbihs }) => {
            const MiniTree = ({ count, darkMode }) => {
                const FRUIT_POSITIONS = [
                    { cx: 150, cy: 50, r: 6 }, { cx: 120, cy: 60, r: 7 }, { cx: 180, cy: 55, r: 6 },
                    { cx: 90, cy: 130, r: 5 }, { cx: 210, cy: 110, r: 6 }, { cx: 140, cy: 90, r: 7 },
                    { cx: 160, cy: 110, r: 6 }, { cx: 110, cy: 80, r: 5 }, { cx: 190, cy: 75, r: 6 },
                    { cx: 70, cy: 90, r: 5 }, { cx: 230, cy: 80, r: 6 }, { cx: 130, cy: 130, r: 5 },
                    { cx: 170, cy: 130, r: 6 }, { cx: 100, cy: 110, r: 5 }, { cx: 200, cy: 90, r: 6 },
                    { cx: 150, cy: 30, r: 5 }, { cx: 120, cy: 40, r: 5 }, { cx: 180, cy: 40, r: 5 },
                    { cx: 80, cy: 110, r: 5 }, { cx: 220, cy: 95, r: 6 }, { cx: 150, cy: 150, r: 6 },
                    { cx: 135, cy: 70, r: 7 }, { cx: 165, cy: 70, r: 7 }, { cx: 60, cy: 80, r: 4 },
                    { cx: 240, cy: 60, r: 4 }, { cx: 100, cy: 50, r: 5 }, { cx: 200, cy: 50, r: 5 },
                    { cx: 150, cy: 75, r: 8 }, { cx: 115, cy: 100, r: 6 }, { cx: 185, cy: 100, r: 6 }
                ];

                let currentScale = 0.3; 
                if (count > 0) {
                    const progressTo100 = Math.min(count, 100) / 100;
                    currentScale = 0.2 + (Math.pow(progressTo100, 2.5) * 0.8);
                }
                currentScale = Math.min(currentScale, 0.85);

                let densityProgress = 0;
                if (count > 100) {
                    const rawDensity = Math.min((count - 100) / 400, 1);
                    densityProgress = Math.pow(rawDensity, 1.5); 
                }

                let mainLeafColor = darkMode ? "#22c55e" : "#4ade80"; 
                let trunkColor = darkMode ? "#5e4b35" : "#8B4513";
                let isMixedLeaves = false;
                let mixedPalette = [];
                let fruitColor = "transparent";
                let visibleFruitCount = 0;
                let isMixedFruit = false;
                
                const total = count;

                if (total < 500) {
                    if (total >= 100) {
                        const ratio = (total - 100) / 400;
                        const lightness = darkMode ? 50 - (ratio * 20) : 60 - (ratio * 25);
                        const saturation = darkMode ? 60 + (ratio * 10) : 70 + (ratio * 15);
                        mainLeafColor = `hsl(142, ${saturation}%, ${lightness}%)`;
                    }
                }
                else if (total >= 500 && total < 1000) {
                    mainLeafColor = darkMode ? "#fbbf24" : "#facc15"; 
                }
                else if (total >= 1000 && total < 1500) {
                    mainLeafColor = darkMode ? "#ec4899" : "#f472b6"; 
                }
                else if (total >= 1500 && total < 3000) {
                    mainLeafColor = darkMode ? "#ef4444" : "#dc2626"; 
                    visibleFruitCount = Math.min(Math.floor((total - 1500) / 100), FRUIT_POSITIONS.length);
                    fruitColor = "#fcd34d"; 
                }
                else if (total >= 3000 && total < 5000) {
                    isMixedLeaves = true;
                    mixedPalette = darkMode 
                        ? ["#fbbf24", "#ec4899", "#22c55e"] 
                        : ["#facc15", "#f472b6", "#4ade80"];
                    trunkColor = darkMode ? "#4a3b2a" : "#5D4037";
                    visibleFruitCount = FRUIT_POSITIONS.length;
                    fruitColor = "#fff"; 
                }
                else if (total >= 5000) {
                    isMixedLeaves = true;
                    mixedPalette = darkMode 
                        ? ["#0ea5e9", "#ef4444", "#fbbf24"] 
                        : ["#0ea5e9", "#ef4444", "#fbbf24"]; 
                    trunkColor = "#312e81"; 
                    visibleFruitCount = FRUIT_POSITIONS.length;
                    fruitColor = "#ffffff";
                    isMixedFruit = true;
                }

                const getLeafColor = (index) => {
                    if (!isMixedLeaves) return mainLeafColor;
                    return mixedPalette[index % mixedPalette.length];
                };

                const getFruitColor = (index) => {
                    if (isMixedFruit) {
                        const colors = ["#fff", "#fef08a", "#bae6fd"];
                        return colors[index % colors.length];
                    }
                    return fruitColor;
                };

                return (
                    <svg viewBox="0 0 300 300" className="w-full h-full overflow-visible" style={{ transform: `scale(${currentScale})`, transformOrigin: 'bottom center' }}>
                        <g transform-origin="150 280">
                            <path d="M150,280 Q160,200 145,150 T150,50" stroke={trunkColor} strokeWidth="18" fill="none" strokeLinecap="round" />
                            <path d="M150,280 Q130,290 120,300" stroke={trunkColor} strokeWidth="12" fill="none" strokeLinecap="round" />
                            <path d="M150,280 Q170,290 180,300" stroke={trunkColor} strokeWidth="12" fill="none" strokeLinecap="round" />

                            <g stroke={trunkColor} fill="none" strokeLinecap="round">
                                <path d="M148,180 Q110,160 90,130" strokeWidth="12" />
                                <path d="M152,160 Q190,140 210,110" strokeWidth="11" />
                            </g>

                            <g stroke={trunkColor} fill="none" strokeLinecap="round" opacity={densityProgress}>
                                <path d="M90,130 Q70,110 60,80" strokeWidth="8" />
                                <path d="M210,110 Q230,90 240,60" strokeWidth="8" />
                                <path d="M148,110 Q120,90 110,60" strokeWidth="8" />
                                <path d="M152,100 Q180,80 190,50" strokeWidth="8" />
                            </g>
                            
                            <g>
                                <circle cx="150" cy="50" r="45" opacity="0.95" fill={getLeafColor(0)} />
                                <circle cx="90" cy="130" r="35" opacity="0.9" fill={getLeafColor(1)} />
                                <circle cx="210" cy="110" r="38" opacity="0.9" fill={getLeafColor(2)} />
                                <circle cx="120" cy="60" r="35" opacity="0.85" fill={getLeafColor(3)} />
                                <circle cx="180" cy="55" r="38" opacity="0.85" fill={getLeafColor(4)} />

                                <g opacity={Math.min(densityProgress + 0.2, 1)}>
                                    <circle cx="60" cy="80" r="32" opacity="0.95" fill={getLeafColor(5)} />
                                    <circle cx="240" cy="60" r="34" opacity="0.95" fill={getLeafColor(6)} />
                                    <circle cx="110" cy="60" r="30" opacity="0.9" fill={getLeafColor(7)} />
                                    <circle cx="190" cy="50" r="30" opacity="0.9" fill={getLeafColor(8)} />
                                </g>
                                <g opacity={densityProgress}>
                                    <circle cx="150" cy="80" r="40" opacity="0.8" fill={getLeafColor(9)} />
                                    <circle cx="85" cy="100" r="28" opacity="0.85" fill={getLeafColor(10)} />
                                    <circle cx="215" cy="80" r="30" opacity="0.85" fill={getLeafColor(11)} />
                                    <circle cx="130" cy="30" r="25" opacity="0.9" fill={getLeafColor(12)} />
                                    <circle cx="170" cy="30" r="25" opacity="0.9" fill={getLeafColor(13)} />
                                </g>
                            </g>

                            {visibleFruitCount > 0 && (
                                <g>
                                    {FRUIT_POSITIONS.slice(0, visibleFruitCount).map((pos, index) => (
                                        <circle 
                                            key={index}
                                            cx={pos.cx} 
                                            cy={pos.cy} 
                                            r={pos.r} 
                                            fill={getFruitColor(index)}
                                        />
                                    ))}
                                </g>
                            )}
                        </g>
                    </svg>
                );
            };

            const liveTrees = tasbihs
                .filter(t => t.count >= 100)
                .map(t => ({
                    id: `live_${t.id}`,
                    tasbihName: t.name,
                    date: new Date().toISOString(),
                    count: t.count,
                    isLive: true
                }));

            const allTrees = [...liveTrees, ...[...trees].reverse()];

            const groups = [];
            
            allTrees.forEach(tree => {
                let dateLabel = '';
                if (tree.isLive) {
                    dateLabel = '‡¶Ü‡¶ú';
                } else {
                    dateLabel = new Date(tree.date).toLocaleDateString('bn-BD', { day: 'numeric', month: 'long', year: 'numeric' });
                }

                let group = groups.find(g => g.date === dateLabel);
                if (!group) {
                    group = { date: dateLabel, trees: [] };
                    groups.push(group);
                }
                group.trees.push(tree);
            });

            return (
                <div className="min-h-screen bg-slate-50 dark:bg-night-900 pb-24">
                <div className="bg-white dark:bg-night-800 p-4 sticky top-0 z-10 shadow-sm flex items-center justify-between">
                    <h2 className="font-bold text-lg dark:text-white flex items-center gap-2">
                        <Sprout size={20} className="text-islamic-600"/> ‡¶Ü‡¶Æ‡¶≤‡ßá‡¶∞ ‡¶¨‡¶æ‡¶ó‡¶æ‡¶®
                    </h2>
                    <div className="bg-islamic-50 dark:bg-islamic-900/30 px-3 py-1 rounded-full border border-islamic-100 dark:border-islamic-800">
                        <span className="text-xs font-bold text-islamic-700 dark:text-islamic-400">‡¶Æ‡ßã‡¶ü ‡¶ó‡¶æ‡¶õ: {allTrees.length}</span>
                    </div>
                </div>

                <div className="p-4 space-y-6">
                    {allTrees.length === 0 ? (
                        <div className="flex flex-col items-center justify-center min-h-[60vh] text-center px-6">
                            <div className="w-24 h-24 bg-gradient-to-br from-emerald-100 to-green-50 dark:from-emerald-900/20 dark:to-green-900/10 rounded-full flex items-center justify-center mb-6">
                                <TreeDeciduous size={48} className="text-emerald-500/50" />
                            </div>
                            <h3 className="text-xl font-bold text-slate-700 dark:text-slate-200 mb-2">‡¶¨‡¶æ‡¶ó‡¶æ‡¶® ‡¶è‡¶ñ‡¶®‡ßã ‡¶ñ‡¶æ‡¶≤‡¶ø</h3>
                            <p className="text-sm text-slate-500 dark:text-slate-400 leading-relaxed max-w-xs mx-auto">
                                ‡¶Ø‡ßá‡¶ï‡ßã‡¶®‡ßã ‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß‡ß¶‡ß¶ ‡¶¨‡¶æ‡¶∞ ‡¶™‡¶æ‡¶† ‡¶ï‡¶∞‡¶≤‡ßá ‡¶§‡¶æ ‡¶è‡¶ñ‡¶æ‡¶®‡ßá ‡¶ó‡¶æ‡¶õ ‡¶π‡¶ø‡¶∏‡ßá‡¶¨‡ßá ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡¶¨‡ßá‡•§ ‡¶Ü‡¶ú ‡¶¨‡ßá‡¶∂‡¶ø ‡¶¨‡ßá‡¶∂‡¶ø ‡¶Ü‡¶Æ‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶ï‡¶ü‡¶ø ‡¶∏‡ßÅ‡¶®‡ßç‡¶¶‡¶∞ ‡¶¨‡¶æ‡¶ó‡¶æ‡¶®‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø! üå≥
                            </p>
                        </div>
                    ) : (
                        groups.map((group) => (
                            <div key={group.date}>
                                <div className="flex items-center gap-2 mb-3 px-1">
                                    <CalendarDays size={16} className="text-slate-400" />
                                    <h3 className="text-sm font-bold text-slate-600 dark:text-slate-300">{group.date}</h3>
                                    <div className="flex-1 h-px bg-slate-100 dark:bg-slate-800"></div>
                                    <span className="text-xs text-slate-400 font-mono">({group.trees.length})</span>
                                </div>

                                <div className="grid grid-cols-2 gap-4">
                                    {group.trees.map((tree) => (
                                        <div key={tree.id} className={`rounded-2xl p-4 shadow-sm border flex flex-col items-center relative overflow-hidden group transition-all ${tree.isLive ? 'bg-indigo-50/50 dark:bg-indigo-900/10 border-indigo-100 dark:border-indigo-800 ring-1 ring-indigo-200 dark:ring-indigo-700' : 'bg-white dark:bg-night-800 border-slate-100 dark:border-slate-800'}`}>
                                            <div className="absolute inset-x-0 bottom-0 h-1/3 bg-gradient-to-t from-emerald-50 to-transparent dark:from-emerald-900/10 pointer-events-none"></div>
                                            
                                            <div className="w-full h-32 flex items-end justify-center mb-2 z-10">
                                                <MiniTree count={tree.count} darkMode={document.documentElement.classList.contains('dark')} />
                                            </div>

                                            <div className="text-center z-10 w-full">
                                                <h4 className="font-bold text-slate-800 dark:text-slate-100 text-sm truncate">{tree.tasbihName}</h4>
                                                <div className={`mt-2 inline-block px-2 py-0.5 rounded text-[10px] font-bold ${tree.isLive ? 'bg-indigo-100 dark:bg-indigo-900 text-indigo-700 dark:text-indigo-300' : 'bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300'}`}>
                                                    {tree.count} ‡¶¨‡¶æ‡¶∞
                                                </div>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            </div>
                        ))
                    )}
                </div>
                </div>
            );
        };

        // BottomNav Component
        const BottomNav = ({ currentView, onNavigate }) => {
            const getButtonClass = (view) => 
                `flex flex-col items-center justify-center w-full py-3 transition-colors ${
                currentView === view 
                    ? 'text-islamic-600 dark:text-islamic-400 font-bold' 
                    : 'text-slate-400 hover:text-slate-600 dark:hover:text-slate-300'
                }`;

            return (
                <div className="absolute bottom-0 left-0 w-full bg-white dark:bg-slate-800 border-t border-slate-100 dark:border-slate-700 flex justify-around items-center pb-safe z-50">
                <button onClick={() => onNavigate(View.HOME)} className={getButtonClass(View.HOME)}>
                    <Home size={24} strokeWidth={currentView === View.HOME ? 2.5 : 2} />
                    <span className="text-[10px] mt-1">‡¶π‡ßã‡¶Æ</span>
                </button>
                
                <button onClick={() => onNavigate(View.JOURNAL)} className={getButtonClass(View.JOURNAL)}>
                    <BookOpen size={24} strokeWidth={currentView === View.JOURNAL ? 2.5 : 2} />
                    <span className="text-[10px] mt-1">‡¶ú‡¶æ‡¶∞‡ßç‡¶®‡¶æ‡¶≤</span>
                </button>

                <button onClick={() => onNavigate(View.GARDEN)} className={getButtonClass(View.GARDEN)}>
                    <Sprout size={24} strokeWidth={currentView === View.GARDEN ? 2.5 : 2} />
                    <span className="text-[10px] mt-1">‡¶¨‡¶æ‡¶ó‡¶æ‡¶®</span>
                </button>
                
                <button onClick={() => onNavigate(View.ANALYSIS)} className={getButtonClass(View.ANALYSIS)}>
                    <BarChart2 size={24} strokeWidth={currentView === View.ANALYSIS ? 2.5 : 2} />
                    <span className="text-[10px] mt-1">‡¶¨‡¶ø‡¶∂‡ßç‡¶≤‡ßá‡¶∑‡¶£</span>
                </button>
                </div>
            );
        };

        // App Component
        const App = () => {
            const [view, setView] = useState(View.HOME);
            const [activeTasbihId, setActiveTasbihId] = useState(null);
            
            const [tasbihs, setTasbihs] = useState(() => {
                const saved = localStorage.getItem('tasbihs');
                return saved ? JSON.parse(saved) : DEFAULT_TASBIHS;
            });

            const [targets, setTargets] = useState(() => {
                const saved = localStorage.getItem('targets');
                return saved ? JSON.parse(saved) : DEFAULT_TARGETS;
            });

            const [journal, setJournal] = useState(() => {
                const saved = localStorage.getItem('journal');
                return saved ? JSON.parse(saved) : [];
            });

            const [garden, setGarden] = useState(() => {
                const saved = localStorage.getItem('garden');
                return saved ? JSON.parse(saved) : [];
            });

            const [stats, setStats] = useState(() => {
                const saved = localStorage.getItem('stats');
                const parsed = saved ? JSON.parse(saved) : {};
                
                return {
                totalNeki: parsed.totalNeki || 0,
                totalXP: parsed.totalXP || 0,
                level: parsed.level || 1,
                streak: parsed.streak || 0,
                lastActiveDate: parsed.lastActiveDate || new Date().toISOString().split('T')[0],
                todayNeki: parsed.todayNeki || 0,
                todayJournalCount: parsed.todayJournalCount || 0,
                lastHadithDate: parsed.lastHadithDate || '',
                shownHadithIndices: parsed.shownHadithIndices || [] 
                };
            });

            const [history, setHistory] = useState(() => {
                const saved = localStorage.getItem('history');
                return saved ? JSON.parse(saved) : [];
            });

            const [inbox, setInbox] = useState(() => {
                const saved = localStorage.getItem('inbox');
                let messages = saved ? JSON.parse(saved) : [WELCOME_MESSAGE, DISCLAIMER_MESSAGE, DEMO_REPORT_MESSAGE];
                
                const cutoffTime = Date.now() - (48 * 60 * 60 * 1000);
                messages = messages.filter((m) => new Date(m.date).getTime() > cutoffTime);
                
                return messages;
            });

            const [darkMode, setDarkMode] = useState(() => {
                return localStorage.getItem('theme') === 'dark';
            });

            useEffect(() => { localStorage.setItem('tasbihs', JSON.stringify(tasbihs)); }, [tasbihs]);
            useEffect(() => { localStorage.setItem('targets', JSON.stringify(targets)); }, [targets]);
            useEffect(() => { localStorage.setItem('journal', JSON.stringify(journal)); }, [journal]);
            useEffect(() => { localStorage.setItem('garden', JSON.stringify(garden)); }, [garden]);
            useEffect(() => { localStorage.setItem('stats', JSON.stringify(stats)); }, [stats]);
            useEffect(() => { localStorage.setItem('inbox', JSON.stringify(inbox)); }, [inbox]);
            useEffect(() => { localStorage.setItem('history', JSON.stringify(history)); }, [history]);
            
            useEffect(() => {
                if (darkMode) {
                document.documentElement.classList.add('dark');
                localStorage.setItem('theme', 'dark');
                } else {
                document.documentElement.classList.remove('dark');
                localStorage.setItem('theme', 'light');
                }
            }, [darkMode]);

            useEffect(() => {
                const now = new Date();
                const todayStr = now.toISOString().split('T')[0];

                const cutoffTime = Date.now() - (48 * 60 * 60 * 1000);
                setInbox(prev => prev.filter(m => new Date(m.date).getTime() > cutoffTime));
                
                if (stats.lastActiveDate !== todayStr) {
                    const activeTasbihs = tasbihs.filter(t => t.count > 0);
                    const completedTargets = targets.filter(t => t.completed);
                    const totalTimeSeconds = tasbihs.reduce((acc, t) => acc + (t.todayTime || 0), 0);
                    
                    const gardenCandidates = activeTasbihs.filter(t => t.count >= 100);
                    let newTrees = [];
                    
                    if (gardenCandidates.length > 0) {
                        newTrees = gardenCandidates.map(t => ({
                            id: `${stats.lastActiveDate}_${t.id}`, 
                            tasbihName: t.name,
                            date: stats.lastActiveDate, 
                            count: t.count 
                        }));
                        
                        setGarden(prev => [...prev, ...newTrees]);
                    }

                    const historyEntry = {
                        date: stats.lastActiveDate,
                        totalTime: totalTimeSeconds,
                        totalNeki: stats.todayNeki
                    };
                    
                    setHistory(prev => {
                        const filtered = prev.filter(h => h.date !== stats.lastActiveDate);
                        return [...filtered, historyEntry];
                    });

                    const minutes = Math.floor(totalTimeSeconds / 60);
                    const seconds = totalTimeSeconds % 60;
                    const timeString = `${minutes} ‡¶Æ‡¶ø‡¶®‡¶ø‡¶ü ${seconds} ‡¶∏‡ßá‡¶ï‡ßá‡¶®‡ßç‡¶°`;
                    const todayJournalXP = stats.todayJournalCount * 100;

                    let dailyReportBody = `‡¶Ü‡¶∏‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ ‡¶Ü‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ,\n‡¶ó‡¶§‡¶ï‡¶æ‡¶≤‡ßá‡¶∞ ‡¶Ü‡¶Æ‡¶≤‡ßá‡¶∞ ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü:\n\n`;
                    dailyReportBody += `üìø **‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶™‡¶æ‡¶†:**\n`;
                    if (activeTasbihs.length > 0) {
                        activeTasbihs.forEach(t => { dailyReportBody += `- ${t.name}: ${t.count} ‡¶¨‡¶æ‡¶∞\n`; });
                    } else { dailyReportBody += `‡¶ï‡ßã‡¶®‡ßã ‡¶§‡¶æ‡¶∏‡¶¨‡ßÄ‡¶π ‡¶™‡¶æ‡¶† ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§\n`; }

                    dailyReportBody += `\nüéØ **‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶£:**\n`;
                    if (completedTargets.length > 0) {
                        completedTargets.forEach(t => { dailyReportBody += `- ${t.name}\n`; });
                    } else { dailyReportBody += `‡¶ï‡ßã‡¶®‡ßã ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶£ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶Ø‡¶º‡¶®‡¶ø‡•§\n`; }
                    
                    if (newTrees.length > 0) {
                        dailyReportBody += `\nüå≥ **‡¶¨‡¶æ‡¶ó‡¶æ‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü:**\n‡¶ó‡¶§‡¶ï‡¶æ‡¶≤ ${newTrees.length} ‡¶ü‡¶ø ‡¶ó‡¶æ‡¶õ ‡¶∞‡ßã‡¶™‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá:\n`;
                        newTrees.forEach(t => {
                            dailyReportBody += `- ${t.tasbihName}\n`;
                        });
                    } else {
                        dailyReportBody += `\nüå≥ **‡¶¨‡¶æ‡¶ó‡¶æ‡¶® ‡¶Ü‡¶™‡¶°‡ßá‡¶ü:**\n‡¶ó‡¶§‡¶ï‡¶æ‡¶≤ ‡¶ï‡ßã‡¶®‡ßã ‡¶ó‡¶æ‡¶õ ‡¶∞‡ßã‡¶™‡¶® ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡¶®‡¶ø (‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß‡ß¶‡ß¶ ‡¶¨‡¶æ‡¶∞‡ßá ‡ßß‡¶ü‡¶ø ‡¶ó‡¶æ‡¶õ)‡•§`;
                    }

                    dailyReportBody += `\n\n‚è± **‡¶Æ‡ßã‡¶ü ‡¶∏‡¶Æ‡¶Ø‡¶º ‡¶¨‡ßç‡¶Ø‡¶Ø‡¶º:** ${timeString}`;
                    dailyReportBody += `\n‚ú® **‡¶Ö‡¶∞‡ßç‡¶ú‡¶ø‡¶§ ‡¶®‡ßá‡¶ï‡¶ø:** ${stats.todayNeki}`;
                    dailyReportBody += `\n\nüìñ **‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú:** ${stats.todayJournalCount} ‡¶ü‡¶ø (${todayJournalXP} XP)`;

                    const dailyMsg = {
                        id: Date.now().toString() + '_daily',
                        title: '‡¶¶‡ßà‡¶®‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü',
                        body: dailyReportBody,
                        date: new Date().toISOString(),
                        read: false,
                        type: 'report'
                    };
                    
                    let newMessages = [dailyMsg];
                    
                    if (now.getDay() === 5) { 
                        const totalJournalXP = journal.length * 100;
                        
                        const oneWeekAgo = new Date();
                        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
                        const allHistoryTrees = [...garden, ...newTrees];
                        const weeklyTrees = allHistoryTrees.filter(t => new Date(t.date) > oneWeekAgo);
                        
                        let weeklyTreeStats = "";
                        if (weeklyTrees.length > 0) {
                            const treeCounts = {};
                            weeklyTrees.forEach(t => {
                                treeCounts[t.tasbihName] = (treeCounts[t.tasbihName] || 0) + 1;
                            });
                            weeklyTreeStats = `\nüå≥ **‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶ó‡¶æ‡¶õ ‡¶∞‡ßã‡¶™‡¶®:** ${weeklyTrees.length} ‡¶ü‡¶ø\n`;
                            Object.entries(treeCounts).forEach(([name, count]) => {
                                weeklyTreeStats += `- ${name}: ${count} ‡¶ü‡¶ø\n`;
                            });
                        } else {
                            weeklyTreeStats = `\nüå≥ **‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶ó‡¶æ‡¶õ ‡¶∞‡ßã‡¶™‡¶®:** ‡ß¶ ‡¶ü‡¶ø\n`;
                        }

                        const weeklyMsg = {
                            id: Date.now().toString() + '_weekly',
                            title: '‡¶∏‡¶æ‡¶™‡ßç‡¶§‡¶æ‡¶π‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü (‡¶ú‡ßÅ‡¶Æ‡¶æ ‡¶Æ‡ßÅ‡¶¨‡¶æ‡¶∞‡¶ï)',
                            body: `‡¶Ü‡¶∏‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ ‡¶Ü‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ,\n‡¶ú‡ßÅ‡¶Æ‡¶æ ‡¶Æ‡ßÅ‡¶¨‡¶æ‡¶∞‡¶ï! ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶Æ‡¶≤‡ßá‡¶∞ ‡¶Ö‡¶ó‡ßç‡¶∞‡¶ó‡¶§‡¶ø:\n\n‚ú® **‡¶∏‡¶∞‡ßç‡¶¨‡¶Æ‡ßã‡¶ü ‡¶®‡ßá‡¶ï‡¶ø:** ${stats.totalNeki}\nüìú **‡¶Æ‡ßã‡¶ü ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú:** ${journal.length} ‡¶ü‡¶ø (${totalJournalXP} XP)\nüî• **‡¶¨‡¶∞‡ßç‡¶§‡¶Æ‡¶æ‡¶® ‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßÄ‡¶ï:** ${stats.streak} ‡¶¶‡¶ø‡¶®\n${weeklyTreeStats}\n‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶ï‡¶≤ ‡¶á‡¶¨‡¶æ‡¶¶‡¶§ ‡¶ï‡¶¨‡ßÅ‡¶≤ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`,
                            date: new Date().toISOString(),
                            read: false,
                            type: 'weekly_report'
                        };
                        newMessages.push(weeklyMsg);
                    }

                    if (now.getDate() === 1) {
                        const totalJournalXP = journal.length * 100;
                        
                        const oneMonthAgo = new Date();
                        oneMonthAgo.setDate(oneMonthAgo.getDate() - 30);
                        const allHistoryTrees = [...garden, ...newTrees];
                        const monthlyTrees = allHistoryTrees.filter(t => new Date(t.date) > oneMonthAgo);

                        let monthlyTreeStats = "";
                        if (monthlyTrees.length > 0) {
                            const treeCounts = {};
                            monthlyTrees.forEach(t => {
                                treeCounts[t.tasbihName] = (treeCounts[t.tasbihName] || 0) + 1;
                            });
                            monthlyTreeStats = `\nüå≥ **‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ó‡¶æ‡¶õ ‡¶∞‡ßã‡¶™‡¶®:** ${monthlyTrees.length} ‡¶ü‡¶ø\n`;
                            Object.entries(treeCounts).forEach(([name, count]) => {
                                monthlyTreeStats += `- ${name}: ${count} ‡¶ü‡¶ø\n`;
                            });
                        } else {
                            monthlyTreeStats = `\nüå≥ **‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶ó‡¶æ‡¶õ ‡¶∞‡ßã‡¶™‡¶®:** ‡ß¶ ‡¶ü‡¶ø\n`;
                        }

                        const monthlyMsg = {
                            id: Date.now().toString() + '_monthly',
                            title: '‡¶Æ‡¶æ‡¶∏‡¶ø‡¶ï ‡¶∞‡¶ø‡¶™‡ßã‡¶∞‡ßç‡¶ü',
                            body: `‡¶Ü‡¶∏‡¶∏‡¶æ‡¶≤‡¶æ‡¶Æ‡ßÅ ‡¶Ü‡¶≤‡¶æ‡¶á‡¶ï‡ßÅ‡¶Æ,\n‡¶®‡¶§‡ßÅ‡¶® ‡¶Æ‡¶æ‡¶∏‡ßá‡¶∞ ‡¶∂‡ßÅ‡¶≠‡ßá‡¶ö‡ßç‡¶õ‡¶æ! ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶Ü‡¶Æ‡¶≤‡¶®‡¶æ‡¶Æ‡¶æ‡¶∞ ‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡¶ø‡¶™‡ßç‡¶§ ‡¶∏‡¶æ‡¶∞‡¶∏‡¶Ç‡¶ï‡ßç‡¶∑‡ßá‡¶™:\n\nüìä **‡¶≤‡ßá‡¶≠‡ßá‡¶≤ ‡¶Ö‡¶∞‡ßç‡¶ú‡¶®:** ${stats.level}\nüìú **‡¶Æ‡ßã‡¶ü ‡¶≠‡¶æ‡¶≤‡ßã ‡¶ï‡¶æ‡¶ú:** ${journal.length} ‡¶ü‡¶ø (${totalJournalXP} XP)\n‚ú® **‡¶Æ‡ßã‡¶ü ‡¶®‡ßá‡¶ï‡¶ø:** ${stats.totalNeki}\n${monthlyTreeStats}\n‡¶®‡¶§‡ßÅ‡¶® ‡¶Æ‡¶æ‡¶∏‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶â‡¶¶‡ßç‡¶Ø‡¶Æ‡ßá ‡¶á‡¶¨‡¶æ‡¶¶‡¶§ ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶∞‡ßÅ‡¶®‡•§`,
                            date: new Date().toISOString(),
                            read: false,
                            type: 'report'
                        };
                        newMessages.push(monthlyMsg);
                    }

                    setInbox(prev => [...newMessages, ...prev]);

                    setTasbihs(prev => prev.map(t => ({ ...t, count: 0, todayTime: 0 })));
                    setTargets(prev => prev.map(t => ({ ...t, completed: false })));

                    const yesterday = new Date();
                    yesterday.setDate(yesterday.getDate() - 1);
                    const yesterdayStr = yesterday.toISOString().split('T')[0];
                    
                    let newStreak = stats.streak;
                    if (stats.lastActiveDate === yesterdayStr) {
                        newStreak += 1;
                    } else if (stats.lastActiveDate !== todayStr) {
                        newStreak = 1; 
                    }

                    setStats(prev => ({
                        ...prev,
                        lastActiveDate: todayStr,
                        todayNeki: 0,
                        todayJournalCount: 0,
                        streak: newStreak
                    }));
                }

                if (stats.lastHadithDate !== todayStr) {
                    const scheduleTime = new Date(now.getFullYear(), now.getMonth(), now.getDate(), 4, 30, 0);
                    if (now >= scheduleTime) {
                        const totalItems = ISLAMIC_DATABASE.length;
                        let currentShown = stats.shownHadithIndices || [];

                        if (currentShown.length >= totalItems) {
                            currentShown = [];
                        }

                        const availableIndices = [];
                        for (let i = 0; i < totalItems; i++) {
                            if (!currentShown.includes(i)) {
                                availableIndices.push(i);
                            }
                        }

                        let selectedIndex = 0;
                        if (availableIndices.length > 0) {
                            const randomPointer = Math.floor(Math.random() * availableIndices.length);
                            selectedIndex = availableIndices[randomPointer];
                        }

                        const content = ISLAMIC_DATABASE[selectedIndex];
                        const hadithMsg = {
                            id: Date.now().toString() + '_hadith',
                            title: '‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶¨‡¶æ‡¶£‡ßÄ',
                            body: `${content.text}\n\n‚Äî ${content.source}`,
                            date: scheduleTime.toISOString(), 
                            read: false,
                            type: 'info'
                        };

                        setInbox(prev => [hadithMsg, ...prev]);
                        setStats(prev => ({
                            ...prev,
                            shownHadithIndices: currentShown.length >= totalItems ? [selectedIndex] : [...currentShown, selectedIndex],
                            lastHadithDate: todayStr
                        }));
                    }
                }

            }, [stats.lastActiveDate, stats.lastHadithDate, tasbihs, targets]);

            const calculateNeki = (tasbih) => {
                if (tasbih.arabicText && tasbih.arabicText.trim().length > 0) {
                    const cleanText = tasbih.arabicText.replace(/\s/g, '');
                    return cleanText.length * 10;
                }
                if (tasbih.manualNeki && tasbih.manualNeki > 0) {
                    return tasbih.manualNeki;
                }
                return 0;
            };

            const addNeki = (amount) => {
                if (amount === 0) return;
                setStats(prev => {
                const newTotalNeki = prev.totalNeki + amount;
                const newLevel = Math.floor(newTotalNeki / LEVEL_THRESHOLD) + 1;
                return {
                    ...prev,
                    totalNeki: newTotalNeki,
                    todayNeki: prev.todayNeki + amount,
                    level: newLevel
                };
                });
            };

            const handleTasbihUpdate = (id, newCount, increment) => {
                setTasbihs(prev => prev.map(t => t.id === id ? { ...t, count: newCount, totalCount: t.totalCount + increment } : t));
                const tasbih = tasbihs.find(t => t.id === id);
                if (tasbih && increment > 0) {
                const nekiValue = calculateNeki(tasbih);
                addNeki(increment * nekiValue);

                const prevCount = tasbih.count;
                const crossedMilestone = Math.floor(prevCount / 100) < Math.floor(newCount / 100);

                if (crossedMilestone) {
                    toast.success('‡¶Æ‡¶æ‡¶∂‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π! ‡ßß‡ß¶‡ß¶ ‡¶¨‡¶æ‡¶∞ ‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶π‡ßü‡ßá‡¶õ‡ßá', {
                        style: {
                            background: '#16a34a',
                            color: '#fff',
                            fontWeight: 'bold',
                            fontSize: '18px'
                        },
                        iconTheme: {
                            primary: '#fff',
                            secondary: '#16a34a',
                        },
                    });
                    
                    const duration = 2000;
                    const end = Date.now() + duration;

                    (function frame() {
                        confetti({
                        particleCount: 5,
                        angle: 60,
                        spread: 55,
                        origin: { x: 0 },
                        colors: ['#22c55e', '#facc15', '#f472b6']
                        });
                        confetti({
                        particleCount: 5,
                        angle: 120,
                        spread: 55,
                        origin: { x: 1 },
                        colors: ['#22c55e', '#facc15', '#f472b6']
                        });

                        if (Date.now() < end) {
                        requestAnimationFrame(frame);
                        }
                    }());
                }
                }
            };

            const handleTasbihTimeUpdate = (id, newTime) => {
                setTasbihs(prev => prev.map(t => t.id === id ? { ...t, todayTime: newTime } : t));
            };

            const handleTasbihEdit = (updatedTasbih) => {
                setTasbihs(prev => prev.map(t => t.id === updatedTasbih.id ? updatedTasbih : t));
            };

            const handleTargetAdd = (target) => {
                setTargets(prev => [...prev, target]);
            };

            const handleTargetEdit = (updatedTarget) => {
                setTargets(prev => prev.map(t => t.id === updatedTarget.id ? updatedTarget : t));
            };

            const handleTargetDelete = (id) => {
                setTargets(prev => prev.filter(t => t.id !== id));
            };

            const toggleTarget = (id) => {
                const target = targets.find(t => t.id === id);
                if (!target) return;
                if (!target.completed) {
                setTargets(prev => prev.map(t => t.id === id ? { ...t, completed: true } : t));
                addNeki(target.neki);
                const infoMsg = {
                    id: Date.now().toString() + '_target_done',
                    title: '‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶∏‡¶Æ‡ßç‡¶™‡¶®‡ßç‡¶®',
                    body: `‡¶Ü‡¶≤‡¶π‡¶æ‡¶Æ‡¶¶‡ßÅ‡¶≤‡¶ø‡¶≤‡ßç‡¶≤‡¶æ‡¶π, ‡¶Ü‡¶™‡¶®‡¶ø ${target.name} ‡¶ü‡¶æ‡¶∞‡ßç‡¶ó‡ßá‡¶ü ‡¶™‡ßÇ‡¶∞‡¶® ‡¶ï‡¶∞‡ßá‡¶õ‡ßá‡¶®‡•§ ‡¶Ü‡¶≤‡ßç‡¶≤‡¶æ‡¶π ‡¶®‡¶ø‡¶∂‡ßç‡¶ö‡ßç‡¶Ø‡ßü‡¶á ‡¶Ü‡¶™‡¶®‡¶æ‡¶ï‡ßá ‡¶è‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶¶‡¶æ‡¶® ‡¶¶‡¶ø‡¶¨‡ßá‡¶® ‚ò∫Ô∏è`,
                    date: new Date().toISOString(),
                    read: false,
                    type: 'info',
                };
                setInbox(prev => [infoMsg, ...prev]);
                toast.success(`${target.neki} ‡¶®‡ßá‡¶ï‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá!`);
                confetti({ particleCount: 30, spread: 70, origin: { y: 0.6 } });
                } 
            };

            const handleClaimNeki = (msgId, amount) => {
                addNeki(amount);
                setInbox(prev => prev.filter(m => m.id !== msgId));
                toast.success(`${amount} ‡¶®‡ßá‡¶ï‡¶ø ‡¶Ø‡ßã‡¶ó ‡¶π‡ßü‡ßá‡¶õ‡ßá!`);
                confetti({ particleCount: 30, spread: 70, origin: { y: 0.6 } });
            };

            const handleDeleteMultiple = (ids) => {
                setInbox(prev => prev.filter(m => !ids.includes(m.id)));
                toast.success(`${ids.length} ‡¶ü‡¶ø ‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶Æ‡ßÅ‡¶õ‡ßá ‡¶´‡ßá‡¶≤‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá`);
            };

            const addJournalEntry = (text) => {
                const newEntry = {
                id: Date.now().toString(),
                date: new Date().toLocaleDateString('bn-BD'),
                text,
                timestamp: Date.now()
                };
                setJournal(prev => [newEntry, ...prev]);
                setStats(prev => ({ 
                    ...prev, 
                    todayJournalCount: prev.todayJournalCount + 1,
                    totalXP: prev.totalXP + 100
                }));
                toast.success("‡¶ú‡¶æ‡¶∞‡ßç‡¶®‡¶æ‡¶≤ ‡¶Ø‡ßÅ‡¶ï‡ßç‡¶§ ‡¶π‡ßü‡ßá‡¶õ‡ßá (+‡ßß‡ß¶‡ß¶ XP)");
            };

            const renderContent = () => {
                switch (view) {
                case View.HOME:
                    return (
                    <Dashboard 
                        stats={stats} 
                        inboxCount={inbox.filter(m => !m.read).length}
                        totalJournalCount={journal.length}
                        onNavigate={setView}
                        darkMode={darkMode}
                        toggleTheme={() => setDarkMode(!darkMode)}
                    />
                    );
                case View.TASBIH_LIST:
                    return (
                    <TasbihList 
                        tasbihs={tasbihs} 
                        onBack={() => setView(View.HOME)} 
                        onSelect={(id) => { setActiveTasbihId(id); setView(View.FOCUS_MODE); }}
                        onAdd={(tasbih) => setTasbihs([...tasbihs, tasbih])}
                        onEdit={handleTasbihEdit}
                        onDelete={(id) => setTasbihs(tasbihs.filter(t => t.id !== id))}
                    />
                    );
                case View.FOCUS_MODE:
                    const activeTasbih = tasbihs.find(t => t.id === activeTasbihId);
                    if (!activeTasbih) return setView(View.TASBIH_LIST);
                    return (
                    <FocusMode 
                        tasbih={activeTasbih} 
                        onUpdate={(count, inc) => handleTasbihUpdate(activeTasbih.id, count, inc)}
                        onTimeUpdate={(time) => handleTasbihTimeUpdate(activeTasbih.id, time)}
                        onBack={() => setView(View.TASBIH_LIST)}
                        darkMode={darkMode}
                    />
                    );
                case View.TARGET_LIST:
                    return (
                    <TargetList 
                        targets={targets} 
                        onToggle={toggleTarget} 
                        onBack={() => setView(View.HOME)}
                        onAdd={handleTargetAdd}
                        onEdit={handleTargetEdit}
                        onDelete={handleTargetDelete}
                    />
                    );
                case View.JOURNAL:
                    return (
                    <Journal 
                        entries={journal} 
                        onAdd={addJournalEntry} 
                    />
                    );
                case View.GARDEN:
                    return (
                    <Garden trees={garden} tasbihs={tasbihs} />
                    );
                case View.ANALYSIS:
                    return (
                    <Analysis stats={stats} tasbihs={tasbihs} targets={targets} history={history} />
                    );
                case View.INBOX:
                    return (
                    <Inbox 
                        messages={inbox} 
                        onMarkRead={(id) => setInbox(prev => prev.map(m => m.id === id ? { ...m, read: true } : m))}
                        onDelete={(id) => setInbox(prev => prev.filter(m => m.id !== id))}
                        onDeleteMultiple={handleDeleteMultiple}
                        onBack={() => setView(View.HOME)}
                        onClaim={handleClaimNeki}
                    />
                    );
                default:
                    return <Dashboard stats={stats} inboxCount={0} totalJournalCount={journal.length} onNavigate={setView} darkMode={darkMode} toggleTheme={() => setDarkMode(!darkMode)} />;
                }
            };

            return (
                <div className="h-screen w-full flex flex-col overflow-hidden relative bg-islamic-50 dark:bg-night-900">
                <div className="flex-1 overflow-y-auto no-scrollbar pb-20">
                    {renderContent()}
                </div>
                
                {view !== View.FOCUS_MODE && (
                    <BottomNav currentView={view} onNavigate={setView} />
                )}
                <Toaster position="top-center" />
                </div>
            );
        }

        // --- ROOT RENDER ---

        const rootElement = document.getElementById('root');
        if (!rootElement) {
            throw new Error("Could not find root element to mount to");
        }

        const root = ReactDOM.createRoot(rootElement);
        root.render(
            <React.StrictMode>
                <App />
            </React.StrictMode>
        );
    </script>
</body>
    </html>
